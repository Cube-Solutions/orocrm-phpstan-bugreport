!function(){"use strict";function e(e){return function(n){return r=typeof(t=n),(null===t?"null":"object"==r&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":r)===e;var t,r}}function n(e){return function(n){return typeof n===e}}function t(e){return function(n){return e===n}}function r(e){return!(null==e)}function o(){}function u(e){return function(){return e}}function i(e){return e}function c(e,n){return e===n}var l=e("string"),a=e("object"),f=e("array"),s=t(null),m=n("boolean"),d=t(void 0),g=n("function"),p=n("number");function b(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=n.concat(t);return e.apply(null,o)}}function h(e){return function(n){return!e(n)}}function v(){return C}var w=u(!1),y=u(!0),C={fold:function(e,n){return e()},isSome:w,isNone:y,getOr:i,getOrThunk:S,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:u(null),getOrUndefined:u(void 0),or:i,orThunk:S,map:v,each:o,bind:v,exists:w,forall:y,filter:function(){return C},toArray:function(){return[]},toString:u("none()")};function S(e){return e()}function T(e,n){return-1<G.call(e,n)}function x(e,n){for(var t=0,r=e.length;t<r;t++)if(n(e[t],t))return!0;return!1}function R(e,n){for(var t=[],r=0;r<e;r++)t.push(n(r));return t}function D(e,n){for(var t=e.length,r=new Array(t),o=0;o<t;o++){var u=e[o];r[o]=n(u,o)}return r}function O(e,n){for(var t=0,r=e.length;t<r;t++)n(e[t],t)}function A(e,n){for(var t=[],r=[],o=0,u=e.length;o<u;o++){var i=e[o];(n(i,o)?t:r).push(i)}return{pass:t,fail:r}}function k(e,n){for(var t=[],r=0,o=e.length;r<o;r++){var u=e[r];n(u,r)&&t.push(u)}return t}function I(e,n,t){return function(e){for(var r,o=e.length-1;0<=o;o--)r=e[o],t=n(t,r,o)}(e),t}function B(e,n,t){return O(e,(function(e,r){t=n(t,e,r)})),t}function M(e,n){return function(e,n,t){for(var r=0,o=e.length;r<o;r++){var u=e[r];if(n(u,r))return q.some(u);if(t(u,r))break}return q.none()}(e,n,w)}function E(e,n){for(var t=0,r=e.length;t<r;t++)if(n(e[t],t))return q.some(t);return q.none()}function P(e){for(var n=[],t=0,r=e.length;t<r;++t){if(!f(e[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+e);$.apply(n,e[t])}return n}function N(e,n){return P(D(e,n))}function z(e,n){for(var t=0,r=e.length;t<r;++t)if(!0!==n(e[t],t))return!1;return!0}function L(e,n){for(var t={},r=0,o=e.length;r<o;r++){var u=e[r];t[String(u)]=n(u,r)}return t}function _(e){return[e]}function W(e,n){return 0<=n&&n<e.length?q.some(e[n]):q.none()}function j(e){return W(e,0)}function F(e){return W(e,e.length-1)}function H(e,n){for(var t=0;t<e.length;t++){var r=n(e[t],t);if(r.isSome())return r}return q.none()}var V=function(e){function n(){return o}function t(n){return n(e)}var r=u(e),o={fold:function(n,t){return t(e)},isSome:y,isNone:w,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:n,orThunk:n,map:function(n){return V(n(e))},each:function(n){n(e)},bind:t,exists:t,forall:t,filter:function(n){return n(e)?o:C},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},q={some:V,none:v,from:function(e){return null==e?C:V(e)}},U=Array.prototype.slice,G=Array.prototype.indexOf,$=Array.prototype.push,K=function(){return(K=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};function X(e,n,t){if(t||2===arguments.length)for(var r,o=0,u=n.length;o<u;o++)!r&&o in n||((r=r||Array.prototype.slice.call(n,0,o))[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))}function Y(e){var n,t=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t||(t=!0,n=e.apply(null,r)),n}}function J(e,n){var t=String(n).toLowerCase();return M(e,(function(e){return e.search(t)}))}function Q(e,n,t){return""===n||e.length>=n.length&&e.substr(t,t+n.length)===n}function Z(e,n){return-1!==e.indexOf(n)}function ee(e,n){return Q(e,n,e.length-n.length)}function ne(e){return 0<e.length}function te(e){return function(n){return Z(n,e)}}function re(e){return window.matchMedia(e).matches}function oe(e,n){var t=e.dom;if(1!==t.nodeType)return!1;var r=t;if(void 0!==r.matches)return r.matches(n);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(n);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(n);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}function ue(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount}function ie(e,n){var t=void 0===n?document:n.dom;return ue(t)?q.none():q.from(t.querySelector(e)).map(Ve.fromDom)}function ce(e,n){return e.dom===n.dom}function le(e,n){return He().browser.isIE()?(t=e.dom,r=n.dom,o=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(t.compareDocumentPosition(r)&o)):(u=e.dom)!==(i=n.dom)&&u.contains(i);var t,r,o,u,i}function ae(e,n){for(var t=Ue(e),r=0,o=t.length;r<o;r++){var u=t[r];n(e[u],u)}}function fe(e,n){return $e(e,(function(e,t){return{k:t,v:n(e,t)}}))}function se(e,n){var t={},r=n,u=t,i=function(e,n){u[n]=e},c=o;return ae(e,(function(e,n){(r(e,n)?i:c)(e,n)})),t}function me(e,n){var t=[];return ae(e,(function(e,r){t.push(n(e,r))})),t}function de(e){return me(e,i)}function ge(e){return Ue(e).length}function pe(e,n){return Ke(e,n)?q.from(e[n]):q.none()}function be(e,n){return Ke(e,n)&&void 0!==e[n]&&null!==e[n]}function he(e,n,t){return{element:e,rowspan:n,colspan:t}}function ve(e,n,t){return{element:e,cells:n,section:t}}function we(e,n,t){return{element:e,isNew:n,isLocked:t}}function ye(e,n,t,r){return{element:e,cells:n,section:t,isNew:r}}function Ce(){return De(0,0)}function Se(e){function n(e){return function(){return t===e}}var t=e.current,r=e.version;return{current:t,version:r,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(Me),isSafari:n("Safari")}}function Te(e){function n(e){return function(){return t===e}}var t=e.current,r=e.version;return{current:t,version:r,isWindows:n(Ne),isiOS:n("iOS"),isAndroid:n(ze),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(Le),isFreeBSD:n(_e),isChromeOS:n(We)}}function xe(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}}var Re,De=function(e,n){return{major:e,minor:n}},Oe={nu:De,detect:function(e,n){var t,r,o=String(n).toLowerCase();return 0===e.length?Ce():(r=function(e,n){for(var t=0;t<e.length;t++){var r=e[t];if(r.test(n))return r}}(e,t=o))?De(u(1),u(2)):{major:0,minor:0};function u(e){return Number(t.replace(r,"$"+e))}},unknown:Ce},Ae=function(e,n){return Q(e,n,0)},ke=(Re=/^\s+|\s+$/g,function(e){return e.replace(Re,"")}),Ie=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Be={browsers:u([{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Z(e,"edge/")&&Z(e,"chrome")&&Z(e,"safari")&&Z(e,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ie],search:function(e){return Z(e,"chrome")&&!Z(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Z(e,"msie")||Z(e,"trident")}},{name:"Opera",versionRegexes:[Ie,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:te("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:te("firefox")},{name:"Safari",versionRegexes:[Ie,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Z(e,"safari")||Z(e,"mobile/"))&&Z(e,"applewebkit")}}]),oses:u([{name:"Windows",search:te("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Z(e,"iphone")||Z(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:te("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:te("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:te("linux"),versionRegexes:[]},{name:"Solaris",search:te("sunos"),versionRegexes:[]},{name:"FreeBSD",search:te("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:te("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}])},Me="Firefox",Ee=function(){return Se({current:void 0,version:Oe.unknown()})},Pe=Se,Ne=(u("Edge"),u("Chrome"),u("IE"),u("Opera"),u(Me),u("Safari"),"Windows"),ze="Android",Le="Solaris",_e="FreeBSD",We="ChromeOS",je=function(){return Te({current:void 0,version:Oe.unknown()})},Fe=Te,He=(u(Ne),u("iOS"),u(ze),u("Linux"),u("OSX"),u(Le),u(_e),u(We),Y((function(){return e=navigator.userAgent,n=q.from(navigator.userAgentData),t=re,b=Be.browsers(),h=Be.oses(),v=n.bind((function(e){return n=b,H(e.brands,(function(e){var t=e.brand.toLowerCase();return M(n,(function(e){var n;return t===(null===(n=e.brand)||void 0===n?void 0:n.toLowerCase())})).map((function(n){return{current:n.name,version:Oe.nu(parseInt(e.version,10),0)}}))}));var n})).orThunk((function(){return J(b,n=e).map((function(e){var t=Oe.detect(e.versionRegexes,n);return{current:e.name,version:t}}));var n})).fold(Ee,Pe),w=J(h,r=e).map((function(e){var n=Oe.detect(e.versionRegexes,r);return{current:e.name,version:n}})).fold(je,Fe),{browser:v,os:w,deviceType:(i=v,c=e,l=t,a=(o=w).isiOS()&&!0===/ipad/i.test(c),f=o.isiOS()&&!a,m=(s=o.isiOS()||o.isAndroid())||l("(pointer:coarse)"),d=a||!f&&s&&l("(min-device-width:768px)"),g=f||s&&!d,p=i.isSafari()&&o.isiOS()&&!1===/safari/i.test(c),{isiPad:u(a),isiPhone:u(f),isTablet:u(d),isPhone:u(g),isTouch:u(m),isAndroid:o.isAndroid,isiOS:o.isiOS,isWebView:u(p),isDesktop:u(!g&&!d&&!p)})};var e,n,t,r,o,i,c,l,a,f,s,m,d,g,p,b,h,v,w}))),Ve={fromHtml:function(e,n){var t=(n||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return xe(t.childNodes[0])},fromTag:function(e,n){return xe((n||document).createElement(e))},fromText:function(e,n){return xe((n||document).createTextNode(e))},fromDom:xe,fromPoint:function(e,n,t){return q.from(e.dom.elementFromPoint(n,t)).map(xe)}},qe=oe,Ue=Object.keys,Ge=Object.hasOwnProperty,$e=function(e,n){var t={};return ae(e,(function(e,r){var o=n(e,r);t[o.k]=o.v})),t},Ke=function(e,n){return Ge.call(e,n)},Xe=["tfoot","thead","tbody","colgroup"];function Ye(e){return e.dom.nodeName.toLowerCase()}function Je(e){return e.dom.nodeType}function Qe(e){return function(n){return Je(n)===e}}function Ze(e){return 8===Je(e)||"#comment"===Ye(e)}function en(e){return function(n){return gn(n)&&Ye(n)===e}}function nn(e){return Ve.fromDom(e.dom.ownerDocument)}function tn(e){return bn(e)?e:nn(e)}function rn(e){return q.from(e.dom.parentNode).map(Ve.fromDom)}function on(e,n){for(var t=g(n)?n:w,r=e.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=Ve.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o}function un(e){return q.from(e.dom.previousSibling).map(Ve.fromDom)}function cn(e){return q.from(e.dom.nextSibling).map(Ve.fromDom)}function ln(e){return D(e.dom.childNodes,Ve.fromDom)}function an(e,n){var t=e.dom.childNodes;return q.from(t[n]).map(Ve.fromDom)}function fn(e){return Ve.fromDom(e.dom.host)}function sn(e,n,t){return r=function(e){return oe(e,n)},k(on(e,t),r);var r}function mn(e,n){return t=function(e){return oe(e,n)},k(ln(e),t);var t}function dn(e,n){return ue(t=void 0===e?document:e.dom)?[]:D(t.querySelectorAll(n),Ve.fromDom);var t}"undefined"!=typeof window||Function("return this;")();var gn=Qe(1),pn=Qe(3),bn=Qe(9),hn=Qe(11),vn=g(Element.prototype.attachShadow)&&g(Node.prototype.getRootNode),wn=u(vn),yn=vn?function(e){return Ve.fromDom(e.dom.getRootNode())}:tn,Cn=function(e){var n=pn(e)?e.dom.parentNode:e.dom;if(null==n||null===n.ownerDocument)return!1;var t,o,u,i,c,l=n.ownerDocument;return u=Ve.fromDom(n),c=yn(u),(hn(i=c)&&r(i.dom.host)?q.some(c):q.none()).fold((function(){return l.body.contains(n)}),(t=Cn,o=fn,function(e){return t(o(e))}))},Sn=function(e){var n=e.dom.body;if(null==n)throw new Error("Body is not available yet");return Ve.fromDom(n)},Tn=function(e,n){var t=[];return O(ln(e),(function(e){t=(t=n(e)?t.concat([e]):t).concat(Tn(e,n))})),t};function xn(e,n,t,r,o){return e(t,r)?q.some(t):g(o)&&o(t)?q.none():n(t,r,o)}function Rn(e,n,t){for(var r=e.dom,o=g(t)?t:w;r.parentNode;){r=r.parentNode;var u=Ve.fromDom(r);if(n(u))return q.some(u);if(o(u))break}return q.none()}function Dn(e,n,t){return Rn(e,(function(e){return oe(e,n)}),t)}function On(e,n){return t=function(e){return oe(e,n)},M(e.dom.childNodes,(function(e){return t(Ve.fromDom(e))})).map(Ve.fromDom);var t}function An(e,n){return ie(n,e)}function kn(e,n,t){return xn(oe,Dn,e,n,t)}function In(e,n,t){if(!(l(t)||m(t)||p(t)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",t,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,t+"")}function Bn(e,n,t){In(e.dom,n,t)}function Mn(e,n){var t=e.dom;ae(n,(function(e,n){In(t,n,e)}))}function En(e,n){var t=e.dom.getAttribute(n);return null===t?void 0:t}function Pn(e,n){return q.from(En(e,n))}function Nn(e){return B(e.dom.attributes,(function(e,n){return e[n.name]=n.value,e}),{})}function zn(e,n,t){return void 0===t&&(t=c),e.exists((function(e){return t(e,n)}))}function Ln(e){for(var n=[],t=function(e){n.push(e)},r=0;r<e.length;r++)e[r].each(t);return n}function _n(e,n,t){return e.isSome()&&n.isSome()?q.some(t(e.getOrDie(),n.getOrDie())):q.none()}function Wn(e,n){return e?q.some(n):q.none()}function jn(e){return void 0!==e.style&&g(e.style.getPropertyValue)}function Fn(e,n,t){if(!l(t))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",t,":: Element ",e),new Error("CSS value must be a string: "+t);jn(e)&&e.style.setProperty(n,t)}function Hn(e,n,t){Fn(e.dom,n,t)}function Vn(e,n){var t=e.dom;ae(n,(function(e,n){Fn(t,n,e)}))}function qn(e,n){var t=e.dom,r=window.getComputedStyle(t).getPropertyValue(n);return""!==r||Cn(e)?r:Wt(t,n)}function Un(e,n){var t=e.dom,r=Wt(t,n);return q.from(r).filter((function(e){return 0<e.length}))}function Gn(e,n){var t,r=n;jn(t=e.dom)&&t.style.removeProperty(r),zn(Pn(e,"style").map(ke),"")&&_t(e,"style")}function $n(e,n,t){return void 0===t&&(t=0),Pn(e,n).map((function(e){return parseInt(e,10)})).getOr(t)}function Kn(e,n){return $n(e,n,1)}function Xn(e){return en("col")(e)?1<$n(e,"span",1):1<Kn(e,"colspan")}function Yn(e){return 1<Kn(e,"rowspan")}function Jn(e,n){return parseInt(qn(e,n),10)}function Qn(e,n){return Ht(e,n,y)}function Zn(e,n){return t=["td","th"],(o=void 0===(o=n)?w:n)(r=e)?q.none():T(t,Ye(r))?q.some(r):Dn(r,t.join(","),(function(e){return oe(e,"table")||o(e)}));var t,r,o}function et(e){return Qn(e,"th,td")}function nt(e){return oe(e,"colgroup")?mn(e,"col"):N(Vt(e),(function(e){return mn(e,"col")}))}function tt(e,n){return kn(e,"table",n)}function rt(e){return Qn(e,"tr")}function ot(e,n){return D(e,(function(e){if("colgroup"!==Ye(e))return ve(e,t=D(et(e),(function(e){return he(e,$n(e,"rowspan",1),$n(e,"colspan",1))})),n(e));var t=D(nt(e),(function(e){return he(e,1,$n(e,"span",1))}));return ve(e,t,"colgroup")}))}function ut(e){return rn(e).map((function(e){var n=Ye(e);return T(Xe,n)?n:"tbody"})).getOr("tbody")}function it(e){var n=rt(e);return ot(X(X([],Vt(e),!0),n,!0),ut)}function ct(e,n,t){var r=e.cells,o=r.slice(0,n),u=r.slice(n),i=o.concat(t).concat(u);return qt(e,i)}function lt(e,n,t){return ct(e,n,[t])}function at(e,n,t){e.cells[n]=t}function ft(e,n){return e.cells[n]}function st(e,n){return ft(e,n).element}function mt(e){return e.cells.length}function dt(e){var n=A(e,(function(e){return"colgroup"===e.section}));return{rows:n.fail,cols:n.pass}}function gt(e,n,t){var r=D(e.cells,t);return ye(n(e.element),r,e.section,!0)}function pt(e){return Pn(e,Ut).bind((function(e){return q.from(e.match(/\d+/g))})).map((function(e){return L(e,y)}))}function bt(e){var n,t=me(B(dt(e).rows,(function(e,n){return O(n.cells,(function(n,t){n.isLocked&&(e[t]=!0)})),e}),{}),(function(e,n){return parseInt(n,10)}));return(n=U.call(t,0)).sort(void 0),n}function ht(e){var n={},t=[],r=j(e).map((function(e){return e.element})).bind(tt).bind(pt).getOr({}),o=0,u=0,i=0,c=A(e,(function(e){return"colgroup"===e.section})),l=c.pass;O(c.fail,(function(e){var c=[];O(e.cells,(function(e){for(var t=0;void 0!==n[i+","+t];)t++;for(var o=be(r,t.toString()),l={element:e.element,rowspan:e.rowspan,colspan:e.colspan,row:i,column:t,isLocked:o},a=0;a<e.colspan;a++)for(var f=0;f<e.rowspan;f++){var s=t+a;n[i+f+","+s]=l,u=Math.max(u,s+1)}c.push(l)})),o++,t.push(ve(e.element,c,e.section)),i++}));var a=F(l).map((function(e){var n,t,r=(n={},t=0,O(e.cells,(function(e){var r=e.colspan;R(r,(function(o){var u=t+o;n[u]={element:e.element,colspan:r,column:u}})),t+=r})),n);return{colgroups:[{element:e.element,columns:de(r)}],columns:r}})).getOrThunk((function(){return{colgroups:[],columns:{}}})),f=a.columns,s=a.colgroups;return{grid:{rows:o,columns:u},access:n,all:t,columns:f,colgroups:s}}function vt(e,n){var t=n.column,r=n.column+n.colspan-1,o=n.row,u=n.row+n.rowspan-1;return t<=e.finishCol&&r>=e.startCol&&o<=e.finishRow&&u>=e.startRow}function wt(e,n){return n.column>=e.startCol&&n.column+n.colspan-1<=e.finishCol&&n.row>=e.startRow&&n.row+n.rowspan-1<=e.finishRow}function yt(e,n,t){var r=Gt.findItem(e,n,ce),o=Gt.findItem(e,t,ce);return r.bind((function(e){return o.map((function(n){return t=e,r=n,{startRow:Math.min(t.row,r.row),startCol:Math.min(t.column,r.column),finishRow:Math.max(t.row+t.rowspan-1,r.row+r.rowspan-1),finishCol:Math.max(t.column+t.colspan-1,r.column+r.colspan-1)};var t,r}))}))}function Ct(e,n,t){return yt(e,n,t).map((function(n){return D(Gt.filterItems(e,b(vt,n)),(function(e){return e.element}))}))}function St(e,n){return Gt.findItem(e,n,(function(e,n){return le(n,e)})).map((function(e){return e.element}))}function Tt(e,n,t,r,o){var u=$t(e),i=ce(e,t)?q.some(n):St(u,n),c=ce(e,o)?q.some(r):St(u,r);return i.bind((function(e){return c.bind((function(n){return Ct(u,e,n)}))}))}function xt(e,n){rn(e).each((function(t){t.dom.insertBefore(n.dom,e.dom)}))}function Rt(e,n){cn(e).fold((function(){rn(e).each((function(e){Kt(e,n)}))}),(function(e){xt(e,n)}))}function Dt(e,n){an(e,0).fold((function(){Kt(e,n)}),(function(t){e.dom.insertBefore(n.dom,t.dom)}))}function Ot(e,n){xt(e,n),Kt(n,e)}function At(e,n){O(n,(function(t,r){Rt(0===r?e:n[r-1],t)}))}function kt(e,n){O(n,(function(n){Kt(e,n)}))}function It(e){e.dom.textContent="",O(ln(e),(function(e){Xt(e)}))}function Bt(e){var n,t=ln(e);0<t.length&&(n=e,O(t,(function(e){xt(n,e)}))),Xt(e)}function Mt(e){return Yt.get(e)}function Et(e){return Yt.getOption(e)}function Pt(e,n){return Yt.set(e,n)}function Nt(e,n){return k(N(e.all,(function(e){return e.cells})),n)}var zt,Lt,_t=function(e,n){e.dom.removeAttribute(n)},Wt=function(e,n){return jn(e)?e.style.getPropertyValue(n):""},jt=u(10),Ft=u(10),Ht=function(e,n,t){return N(ln(e),(function(e){return oe(e,n)?t(e)?[e]:[]:Ht(e,n,t)}))},Vt=function(e){return tt(e).fold(u([]),(function(e){return mn(e,"colgroup")}))},qt=function(e,n){return ye(e.element,n,e.section,e.isNew)},Ut="data-snooker-locked-cols",Gt={fromTable:function(e){return ht(it(e))},generate:ht,getAt:function(e,n,t){return q.from(e.access[n+","+t])},findItem:function(e,n,t){var r=Nt(e,(function(e){return t(n,e.element)}));return 0<r.length?q.some(r[0]):q.none()},filterItems:Nt,justCells:function(e){return N(e.all,(function(e){return e.cells}))},justColumns:function(e){return de(e.columns)},hasColumns:function(e){return 0<Ue(e.columns).length},getColumnAt:function(e,n){return q.from(e.columns[n])}},$t=Gt.fromTable,Kt=function(e,n){e.dom.appendChild(n.dom)},Xt=function(e){var n=e.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},Yt=(zt=pn,{get:function(e){if(!zt(e))throw new Error("Can only get text value of a text node");return Lt(e).getOr("")},getOption:Lt=function(e){return zt(e)?q.from(e.dom.nodeValue):q.none()},set:function(e,n){if(!zt(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=n}}),Jt=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Qt(){return{up:u({selector:Dn,closest:kn,predicate:Rn,all:on}),down:u({selector:dn,predicate:Tn}),styles:u({get:qn,getRaw:Un,set:Hn,remove:Gn}),attrs:u({get:En,set:Bn,remove:_t,copyTo:function(e,n){Mn(n,Nn(e))}}),insert:u({before:xt,after:Rt,afterAll:At,append:Kt,appendAll:kt,prepend:Dt,wrap:Ot}),remove:u({unwrap:Bt,remove:Xt}),create:u({nu:Ve.fromTag,clone:function(e){return Ve.fromDom(e.dom.cloneNode(!1))},text:Ve.fromText}),query:u({comparePosition:function(e,n){return e.dom.compareDocumentPosition(n.dom)},prevSibling:un,nextSibling:cn}),property:u({children:ln,name:Ye,parent:rn,document:function(e){return tn(e).dom},isText:pn,isComment:Ze,isElement:gn,isSpecial:function(e){return T(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],Ye(e))},getLanguage:function(e){return gn(e)?Pn(e,"lang"):q.none()},getText:Mt,setText:Pt,isBoundary:function(e){return!!gn(e)&&("body"===Ye(e)||T(Jt,Ye(e)))},isEmptyTag:function(e){return!!gn(e)&&T(["br","img","hr","input"],Ye(e))},isNonEditable:function(e){return gn(e)&&"false"===En(e,"contenteditable")}}),eq:ce,is:qe}}function Zt(e,n){return Wr(Fr,(function(n,t){return e(t)}),n)}function er(e){return Dn(e,"table")}function nr(e,n,t){function r(e){return function(n){return void 0!==t&&t(n)||ce(n,e)}}return ce(e,n)?q.some({boxes:q.some([e]),start:e,finish:n}):er(e).bind((function(o){return er(n).bind((function(u){if(ce(o,u))return q.some({boxes:(a=e,f=n,Ct($t(o),a,f)),start:e,finish:n});if(le(o,u)){var i=0<(c=sn(n,"td,th",r(o))).length?c[c.length-1]:n;return q.some({boxes:Tt(o,e,o,n,u),start:e,finish:i})}if(le(u,o)){var c,l=0<(c=sn(e,"td,th",r(u))).length?c[c.length-1]:e;return q.some({boxes:Tt(u,e,o,n,u),start:e,finish:l})}return jr(Fr,e,n,void 0).shared.bind((function(i){return kn(i,"table",t).bind((function(t){var i=sn(n,"td,th",r(t)),c=0<i.length?i[i.length-1]:n,l=sn(e,"td,th",r(t)),a=0<l.length?l[l.length-1]:e;return q.some({boxes:Tt(t,e,o,n,u),start:a,finish:c})}))}));var a,f}))}))}function tr(e,n){var t=dn(e,n);return 0<t.length?q.some(t):q.none()}function rr(e,n,t){return An(e,n).bind((function(n){return An(e,t).bind((function(e){return Zt(er,[n,e]).map((function(t){return{first:n,last:e,table:t}}))}))}))}function or(e,n,t,r,o){return u=o,M(e,(function(e){return oe(e,u)})).bind((function(e){return u=n,i=t,tt(o=e).bind((function(e){var n=$t(e),t=u,r=i;return Gt.findItem(n,o,ce).bind((function(e){var o=0<t?e.row+e.rowspan-1:e.row,u=0<r?e.column+e.colspan-1:e.column;return Gt.getAt(n,o+t,u+r).map((function(e){return e.element}))}))})).bind((function(e){return t=r,Dn(n=e,"table").bind((function(e){return An(e,t).bind((function(e){return nr(e,n).bind((function(e){return e.boxes.map((function(n){return{boxes:n,start:e.start,finish:e.finish}}))}))}))}));var n,t}));var o,u,i}));var u}function ur(e,n,t,r){return e.fold(n,t,r)}function ir(e,n){return Ve.fromDom(e.dom.cloneNode(n))}function cr(e){return ir(e,!1)}function lr(e){return ir(e,!0)}function ar(e,n){var t=Ve.fromTag(n);return Mn(t,Nn(e)),t}function fr(e,n){function t(t){var r=n(t);if(r<=0||null===r){var o=qn(t,e);return parseFloat(o)||0}return r}function r(e,n){return B(n,(function(n,t){var r=qn(e,t),o=void 0===r?0:parseInt(r,10);return isNaN(o)?n:n+o}),0)}return{set:function(n,t){if(!p(t)&&!t.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+t);var r=n.dom;jn(r)&&(r.style[e]=t+"px")},get:t,getOuter:t,aggregate:r,max:function(e,n,t){var o=r(e,t);return o<n?n-o:0}}}function sr(){var e=He().browser;return e.isIE()||e.isEdge()}function mr(e,n,t){return r=qn(e,n),o=t,u=parseFloat(r),(isNaN(u)?q.none():q.some(u)).getOr(o);var r,o,u}function dr(e){return qn(e,"box-sizing")}function gr(e,n,t,r){return n-mr(e,"padding-"+t,0)-mr(e,"padding-"+r,0)-mr(e,"border-"+t+"-width",0)-mr(e,"border-"+r+"-width",0)}function pr(e,n){var t=e.dom,r=t.getBoundingClientRect().width||t.offsetWidth;return"border-box"===n?r:gr(e,r,"left","right")}function br(e){return Kr.get(e)}function hr(e){return Kr.getOuter(e)}function vr(e,n){void 0===n&&(n=y);var t=e.grid,r=R(t.columns,i),o=R(t.rows,i);return D(r,(function(t){return Jr((function(){return N(o,(function(n){return Gt.getAt(e,n,t).filter((function(e){return e.column===t})).toArray()}))}),(function(e){return 1===e.colspan&&n(e.element)}),(function(){return Gt.getAt(e,0,t)}))}))}function wr(e){var n=e.grid,t=R(n.rows,i),r=R(n.columns,i);return D(t,(function(n){return Jr((function(){return N(r,(function(t){return Gt.getAt(e,n,t).filter((function(e){return e.row===n})).fold(u([]),(function(e){return[e]}))}))}),(function(e){return 1===e.rowspan}),(function(){return Gt.getAt(e,n,0)}))}))}function yr(e,n){return function(t){return"rtl"===Qr(t)?n:e}}function Cr(e){return Zr.get(e)}function Sr(e){return Zr.getOuter(e)}function Tr(e,n){return void 0!==e?e:void 0!==n?n:0}function xr(e){var n=e.dom.ownerDocument,t=n.body,r=n.defaultView,o=n.documentElement;if(t===e.dom)return no(t.offsetLeft,t.offsetTop);var u=Tr(null==r?void 0:r.pageYOffset,o.scrollTop),i=Tr(null==r?void 0:r.pageXOffset,o.scrollLeft),c=Tr(o.clientTop,t.clientTop),l=Tr(o.clientLeft,t.clientLeft);return to(e).translate(i-l,u-c)}function Rr(e,n){return{row:e,y:n}}function Dr(e,n){return{col:e,x:n}}function Or(e){return xr(e).left+hr(e)}function Ar(e){return xr(e).left}function kr(e,n){return Dr(e,Ar(n))}function Ir(e,n){return Dr(e,Or(n))}function Br(e){return xr(e).top}function Mr(e,n){return Rr(e,Br(n))}function Er(e,n){return Rr(e,Br(n)+Sr(n))}function Pr(e,n,t){if(0===t.length)return[];var r=D(t.slice(1),(function(n,t){return n.map((function(n){return e(t,n)}))})),o=t[t.length-1].map((function(e){return n(t.length-1,e)}));return r.concat([o])}function Nr(e){if(!f(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var n=[],t={};return O(e,(function(r,o){var u=Ue(r);if(1!==u.length)throw new Error("one and only one name per case");var i=u[0],c=r[i];if(void 0!==t[i])throw new Error("duplicate key detected:"+i);if("cata"===i)throw new Error("cannot have a case named cata (sorry)");if(!f(c))throw new Error("case arguments must be an array");n.push(i),t[i]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var u=t.length;if(u!==c.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+c.length+" ("+c+"), got "+u);return{fold:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(n.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+n.length);return n[o].apply(null,t)},match:function(e){var r=Ue(e);if(n.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+r.join(","));if(!z(n,(function(e){return T(r,e)})))throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+n.join(", "));return e[i].apply(null,t)},log:function(e){console.log(e,{constructors:n,constructor:i,params:t})}}}})),t}var zr,Lr,_r,Wr=function(e,n,t){return 0<t.length?(r=e,o=n,u=t[0],I(t.slice(1),(function(e,n){var t=o(r,n);return function(e,n,t){return n.bind((function(n){return t.filter(b(e.eq,n))}))}(r,e,t)}),o(r,u))):q.none();var r,o,u},jr=function(e,n,t,r){function o(e){return E(e,r).fold((function(){return e}),(function(n){return e.slice(0,n+1)}))}void 0===r&&(r=w);var u=[n].concat(e.up().all(n)),i=[t].concat(e.up().all(t)),c=o(u),l=o(i),a=M(c,(function(n){return x(l,b(e.eq,n))}));return{firstpath:c,secondpath:l,shared:a}},Fr=Qt(),Hr=tr,Vr=Nr([{none:[]},{multiple:["elements"]},{single:["element"]}]),qr=Vr.none,Ur=Vr.multiple,Gr=Vr.single,$r=tinymce.util.Tools.resolve("tinymce.PluginManager"),Kr=fr("width",(function(e){return e.dom.offsetWidth})),Xr=function(e){return pr(e,"content-box")},Yr=function(e){return sr()?pr(e,dr(e)):mr(e,"width",e.dom.offsetWidth)},Jr=function(e,n,t){var r=e();return M(r,n).orThunk((function(){return q.from(r[0]).orThunk(t)})).map((function(e){return e.element}))},Qr=function(e){return"rtl"===qn(e,"direction")?"rtl":"ltr"},Zr=fr("height",(function(e){var n=e.dom;return Cn(e)?n.getBoundingClientRect().height:n.offsetHeight})),eo=function(e,n){return{left:e,top:n,translate:function(t,r){return eo(e+t,n+r)}}},no=eo,to=function(e){var n,t=e.dom,r=t.ownerDocument.body;return r===t?no(r.offsetLeft,r.offsetTop):Cn(e)?(n=t.getBoundingClientRect(),no(n.left,n.top)):no(0,0)},ro={delta:i,positions:function(e){return Pr(Mr,Er,e)},edge:Br},oo=yr({delta:i,edge:Ar,positions:function(e){return Pr(kr,Ir,e)}},{delta:function(e){return-e},edge:Or,positions:function(e){return Pr(Ir,kr,e)}}),uo={delta:function(e,n){return oo(n).delta(e,n)},positions:function(e,n){return oo(n).positions(e,n)},edge:function(e){return oo(e).edge(e)}},io={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},co=(_r=["Infinity",(zr="[0-9]+")+"\\."+lo(zr)+lo(Lr="[eE][+-]?[0-9]+"),"\\."+zr+lo(Lr),zr+lo(Lr)].join("|"),new RegExp("^([+-]?(?:"+_r+"))(.*)$"));function lo(e){return"(?:"+e+")?"}function ao(e,n,t){var r=q.from(e.dom.parentElement).map(Ve.fromDom).getOrThunk((function(){return Sn(nn(e))}));return n(e)/t(r)*100}function fo(e,n){Hn(e,"width",n+"px")}function so(e,n){Hn(e,"width",n+"%")}function mo(e,n){Hn(e,"height",n+"px")}function go(e,n){return Un(e,n).orThunk((function(){return Pn(e,n).map((function(e){return e+"px"}))}))}function po(e){return go(e,"width")}function bo(e){return ao(e,br,Xr)}function ho(e){return(Tl(e)?br:Yr)(e)}function vo(e){return function(e){var n,t,r,o,u,i,c,l,a,f,s=function(e){return sr()?(t=dr(n=e),o=(r=n.dom).getBoundingClientRect().height||r.offsetHeight,"border-box"===t?o:gr(n,o,"top","bottom")):mr(e,"height",e.dom.offsetHeight);var n,t,r,o}(e)+"px";return s?(n=s,t=e,r=Cr,o=mo,f=parseFloat(n),ee(n,"%")&&"table"!==Ye(t)?(i=f,c=r,l=o,a=tt(u=t).map((function(e){var n=c(e);return Math.floor(i/100*n)})).getOr(i),l(u,a),a):f):Cr(e)}(n=e)/Kn(n,"rowspan");var n}function wo(e,n,t){Hn(e,"width",n+t)}function yo(e){return ao(e,br,Xr)+"%"}function Co(e){return po(e).getOrThunk((function(){return ho(e)+"px"}))}function So(e){return go(e,"height").getOrThunk((function(){return vo(e)+"px"}))}function To(e,n,t,r,o,u){return e.filter(r).fold((function(){return u(function(e,n){if(n<0||n>=e.length-1)return q.none();var t=e[n].fold((function(){var t,r;return H((t=e.slice(0,n),(r=U.call(t,0)).reverse(),r),(function(e,n){return e.map((function(e){return{value:e,delta:n+1}}))}))}),(function(e){return q.some({value:e,delta:0})})),r=e[n+1].fold((function(){return H(e.slice(n+1),(function(e,n){return e.map((function(e){return{value:e,delta:n+1}}))}))}),(function(e){return q.some({value:e,delta:1})}));return t.bind((function(e){return r.map((function(n){var t=n.delta+e.delta;return Math.abs(n.value-e.value)/t}))}))}(t,n))}),(function(e){return o(e)}))}function xo(e,n,t,r){var o=vr(e),u=Gt.hasColumns(e)?D(Gt.justColumns(e),(function(e){return q.from(e.element)})):o,i=[q.some(uo.edge(n))].concat(D(uo.positions(o,n),(function(e){return e.map((function(e){return e.x}))}))),c=h(Xn);return D(u,(function(e,n){return To(e,n,i,c,(function(e){return l=e,f=(a=He().browser).isChrome()||a.isFirefox(),!Rl(l)||f?t(e):To(null!=(u=o[n])?u:q.none(),n,i,c,(function(e){return r(q.some(br(e)))}),r);var u,l,a,f}),r)}))}function Ro(e){return e.map((function(e){return e+"px"})).getOr("")}function Do(e,n,t){return xo(e,n,ho,(function(e){return e.getOrThunk(t.minCellWidth)}))}function Oo(e,n,t,r,o){var u=wr(e),i=[q.some(t.edge(n))].concat(D(t.positions(u,n),(function(e){return e.map((function(e){return e.y}))})));return D(u,(function(e,n){return To(e,n,i,h(Yn),r,o)}))}function Ao(e,n){return function(){return Cn(e)?n(e):parseFloat(Un(e,"width").getOr("0"))}}function ko(e){var n=Ao(e,(function(e){return parseFloat(yo(e))})),t=Ao(e,br);return{width:n,pixelWidth:t,getWidths:function(n,t){return r=t,xo(n,e,bo,(function(e){return e.fold((function(){return r.minCellWidth()}),(function(e){return e/r.pixelWidth()*100}))}));var r},getCellDelta:function(e){return e/t()*100},singleColumnWidth:function(e,n){return[100-e]},minCellWidth:function(){return jt()/t()*100},setElementWidth:so,adjustTableWidth:function(t){var r=n();so(e,r+t/100*r)},isRelative:!0,label:"percent"}}function Io(e){var n=Ao(e,br);return{width:n,pixelWidth:n,getWidths:function(n,t){return Do(n,e,t)},getCellDelta:i,singleColumnWidth:function(e,n){return[Math.max(jt(),e+n)-e]},minCellWidth:jt,setElementWidth:fo,adjustTableWidth:function(t){var r=n()+t;fo(e,r)},isRelative:!1,label:"pixel"}}function Bo(e){return"img"===Ye(e)?1:Et(e).fold((function(){return ln(e).length}),(function(e){return e.length}))}function Mo(e){return Et(e).filter((function(e){return 0!==e.trim().length||-1<e.indexOf(" ")})).isSome()||T(kl,Ye(e))}function Eo(e){return n=Mo,(t=function(e){for(var r=0;r<e.childNodes.length;r++){var o=Ve.fromDom(e.childNodes[r]);if(n(o))return q.some(o);var u=t(e.childNodes[r]);if(u.isSome())return u}return q.none()})(e.dom);var n,t}function Po(e){return Il(e,Mo)}function No(e){return function(){var n=Ve.fromTag("td",e.dom);return Kt(n,Ve.fromTag("br",e.dom)),n}}function zo(e){return function(){return Ve.fromTag("col",e.dom)}}function Lo(e){return function(){return Ve.fromTag("colgroup",e.dom)}}function _o(e){return function(){return Ve.fromTag("tr",e.dom)}}function Wo(e,n,t){var r,o,u=(kt(o=ar(r=e,n),ln(lr(r))),o);return ae(t,(function(e,n){null===e?_t(u,n):Bn(u,n,e)})),u}function jo(e){return e}function Fo(e,n,t){function r(e,n){var t=e.element.dom,r=n.dom;jn(t)&&jn(r)&&(r.style.cssText=t.style.cssText),Gn(n,"height"),1!==e.colspan&&Gn(n,"width")}return{col:function(t){var o=Ve.fromTag(Ye(t.element),n.dom);return r(t,o),e(t.element,o),o},colgroup:Lo(n),row:_o(n),cell:function(o){var u,i,c,l,a,f=Ve.fromTag(Ye(o.element),n.dom),s=t.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),m=0<s.length?(u=o.element,i=f,c=s,Eo(u).map((function(e){return I(sn(e,c.join(","),(function(e){return ce(e,u)})),(function(e,n){var t=cr(n);return _t(t,"contenteditable"),Kt(e,t),t}),i)})).getOr(i)):f;return Kt(m,Ve.fromTag("br")),r(o,f),l=o.element,a=f,ae(Bl,(function(e,n){return Pn(l,n).filter((function(n){return T(e,n)})).each((function(e){return Bn(a,n,e)}))})),e(o.element,f),f},replace:Wo,colGap:zo(n),gap:No(n)}}function Ho(e){return{col:zo(e),colgroup:Lo(e),row:_o(e),cell:No(e),replace:jo,colGap:zo(e),gap:No(e)}}function Vo(e){return D(e,Ve.fromDom)}function qo(e){return Ve.fromDom(e.getBody())}function Uo(e){return e.getBoundingClientRect().width}function Go(e){return e.getBoundingClientRect().height}function $o(e){return function(n){return ce(n,qo(e))}}function Ko(e){return/^\d+(\.\d+)?$/.test(e)?e+"px":e}function Xo(e){function n(e){return _t(e,"data-mce-style")}_t(e,"data-mce-style"),O(et(e),n),O(nt(e),n),O(rt(e),n)}function Yo(e){return Ve.fromDom(e.selection.getStart())}function Jo(e){return ur(e.get(),u([]),i,_)}function Qo(e,n,t){return{element:t,mergable:(u=n,i=Ml,ur(e.get(),q.none,(function(e){return e.length<=1?q.none():function(e,n,t){return rr(e,n,t).bind((function(n){function t(n){return ce(e,n)}var r="thead,tfoot,tbody,table",o=Dn(n.first,r,t),u=Dn(n.last,r,t);return o.bind((function(e){return u.bind((function(t){return ce(e,t)?(o=n.table,u=n.first,i=n.last,c=$t(o),yt(r=c,u,i).bind((function(e){return function(e,n){for(var t=!0,r=b(wt,n),o=n.startRow;o<=n.finishRow;o++)for(var u=n.startCol;u<=n.finishCol;u++)t=t&&Gt.getAt(e,o,u).exists(r);return t?q.some(n):q.none()}(r,e)}))):q.none();var r,o,u,i,c}))}))}))}(u,i.firstSelectedSelector,i.lastSelectedSelector).map((function(n){return{bounds:n,cells:e}}))}),q.none)),unmergable:0<(o=Jo(e)).length&&z(o,(function(e){return r(e,"rowspan")||r(e,"colspan")}))?q.some(o):q.none(),selection:Jo(e)};function r(e,n){return Pn(e,n).exists((function(e){return 1<parseInt(e,10)}))}var o,u,i}function Zo(e){return function(n,t){var r,o=Ye(n);return kn("col"===o||"colgroup"===o?tt(r=n).bind((function(e){return Hr(e,Ml.firstSelectedSelector)})).fold(u(r),(function(e){return e[0]})):n,e,t)}}function eu(e,n,t){for(var r=0,o=e;o<n;o++)r+=void 0!==t[o]?t[o]:0;return r}function nu(e,n,t){var r,o,u,i;O((r=e,o=n,Gt.hasColumns(r)?(i=o,D(Gt.justColumns(r),(function(e,n){return{element:e.element,width:i[n],colspan:e.colspan}}))):(u=o,D(Gt.justCells(r),(function(e){var n=eu(e.column,e.column+e.colspan,u);return{element:e.element,width:n,colspan:e.colspan}})))),(function(e){t.setElementWidth(e.element,e.width)}))}function tu(e,n,t,r,o){var i,c,l,a,f,s,m,d,g,p,b=Gt.fromTable(e),h=o.getCellDelta(n),v=o.getWidths(b,o),w=t===b.grid.columns-1,y=r.clampTableDelta(v,t,h,o.minCellWidth(),w),C=(c=t,l=y,a=o,f=r,d=(i=v).slice(0),m=c,g=0===(s=i).length?Ll.none():1===s.length?Ll.only(0):0===m?Ll.left(0,1):m===s.length-1?Ll.right(m-1,m):0<m&&m<s.length-1?Ll.middle(m-1,m,m+1):Ll.none(),p=u(D(d,u(0))),g.fold(p,(function(e){return a.singleColumnWidth(d[e],l)}),(function(e,n){return f.calcLeftEdgeDeltas(d,e,n,l,a.minCellWidth(),a.isRelative)}),(function(e,n,t){return f.calcMiddleDeltas(d,e,n,t,l,a.minCellWidth(),a.isRelative)}),(function(e,n){return f.calcRightEdgeDeltas(d,e,n,l,a.minCellWidth(),a.isRelative)})));nu(b,D(C,(function(e,n){return e+v[n]})),o),r.resizeTable(o.adjustTableWidth,y,w)}function ru(e){return D(e,u(0))}function ou(e,n,t,r,o){return o(e.slice(0,n)).concat(r).concat(o(e.slice(t)))}function uu(e){return function(n,t,r,o){if(e(r)){var u=Math.max(o,n[t]-Math.abs(r)),i=Math.abs(u-n[t]);return 0<=r?i:-i}return r}}function iu(){function e(e,n,t,r){var o=(100+t)/100,u=Math.max(r,(e[n]+t)/o);return D(e,(function(e,t){return(t===n?u:e/o)-e}))}function n(n,t,r,o,u,i){return i?e(n,t,o,u):(a=r,f=_l(c=n,l=t,o,u),ou(c,l,a+1,[f,0],ru));var c,l,a,f}return{resizeTable:function(e,n){return e(n)},clampTableDelta:_l,calcLeftEdgeDeltas:n,calcMiddleDeltas:function(e,t,r,o,u,i,c){return n(e,r,o,u,i,c)},calcRightEdgeDeltas:function(n,t,r,o,u,i){if(i)return e(n,r,o,u);var c=_l(n,r,o,u);return ru(n.slice(0,r)).concat([c])},calcRedestributedWidths:function(e,n,t,r){if(r){var o=(n+t)/n,u=D(e,(function(e){return e/o}));return{delta:100*o-100,newSizes:u}}return{delta:t,newSizes:e}}}}function cu(){function e(e,n,t,r,o){var u=Wl(e,0<=r?t:n,r,o);return ou(e,n,t+1,[u,-u],ru)}return{resizeTable:function(e,n,t){t&&e(n)},clampTableDelta:function(e,n,t,r,o){if(o){if(0<=t)return t;var u=B(e,(function(e,n){return e+n-r}),0);return Math.max(-u,t)}return _l(e,n,t,r)},calcLeftEdgeDeltas:e,calcMiddleDeltas:function(n,t,r,o,u,i){return e(n,r,o,u,i)},calcRightEdgeDeltas:function(e,n,t,r,o,i){return i?ru(e):D(e,u(r/e.length))},calcRedestributedWidths:function(e,n,t,r){return{delta:0,newSizes:e}}}}function lu(e,n,t){var r=t.substring(0,t.length-e.length),o=parseFloat(r);return r===o.toString()?n(o):jl.invalid(t)}function au(e,n,t){var r,o,i,c,l=Fl.from(t),a=z(e,(function(e){return"0px"===e}))?(r=e.length,o=l.fold((function(){return u("")}),(function(e){return u(e/r+"px")}),(function(){return u(100/r+"%")})),R(r,o)):(i=e,c=n,l.fold((function(){return i}),(function(e){return t=(n=e)/c,D(i,(function(e){return Fl.from(e).fold((function(){return e}),(function(e){return e*t+"px"}),(function(e){return e/100*n+"px"}))}));var n,t}),(function(e){return n=c,D(i,(function(e){return Fl.from(e).fold((function(){return e}),(function(e){return e/n*100+"%"}),(function(e){return e+"%"}))}));var n})));return Hl(a)}function fu(e,n){return 0===e.length?n:I(e,(function(e,n){return Fl.from(n).fold(u(0),i,i)+e}),0)}function su(e){return Vl(e).fold(u("px"),u("px"),u("%"))}function mu(e,n,t){var r=Gt.fromTable(e),o=r.all,u=Gt.justCells(r),i=Gt.justColumns(r);n.each((function(n){var t,o,c,l,a=su(n),f=br(e),s=au(xo(r,e,Co,Ro),f,n);Gt.hasColumns(r)?(c=s,l=a,O(i,(function(e,n){var t=fu([c[n]],jt());Hn(e.element,"width",t+l)}))):(t=s,o=a,O(u,(function(e){var n=fu(t.slice(e.column,e.colspan+e.column),jt());Hn(e.element,"width",n+o)}))),Hn(e,"width",n)})),t.each((function(n){var t=su(n),i=Cr(e),c=au(Oo(r,e,ro,So,Ro),i,n),l=o,a=t;O(u,(function(e){var n=fu(c.slice(e.row,e.rowspan+e.row),Ft());Hn(e.element,"height",n+a)})),O(l,(function(e,n){Hn(e.element,"height",c[n])})),Hn(e,"height",n)}))}function du(e){return Gt.fromTable(e).grid}function gu(e){var n=[];return{bind:function(e){if(void 0===e)throw new Error("Event bind error: undefined handler");n.push(e)},unbind:function(e){n=k(n,(function(n){return n!==e}))},trigger:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o={};O(e,(function(e,n){o[e]=t[n]})),O(n,(function(e){e(o)}))}}}function pu(e){return{registry:fe(e,(function(e){return{bind:e.bind,unbind:e.unbind}})),trigger:fe(e,(function(e){return e.trigger}))}}function bu(e){return e.slice(0).sort()}function hu(e,n){var t=k(n,(function(n){return!T(e,n)}));0<t.length&&function(){throw new Error("Unsupported keys for object: "+bu(t).join(", "))}()}function vu(e){return function(e,n,t){if(0===n.length)throw new Error("You must specify at least one required field.");var r;return function(e,n){if(!f(n))throw new Error("The "+e+" fields must be an array. Was: "+n+".");O(n,(function(n){if(!l(n))throw new Error("The value "+n+" in the "+e+" fields was not a string.")}))}("required",n),M(r=bu(n),(function(e,n){return n<r.length-1&&e===r[n+1]})).each((function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+r.join(", ")+"].")})),function(r){var o=Ue(r);z(n,(function(e){return T(o,e)}))||function(e,n){throw new Error("All required keys ("+bu(e).join(", ")+") were not specified. Specified keys were: "+bu(n).join(", ")+".")}(n,o),e(n,o);var u=k(n,(function(e){return!t.validate(r[e],e)}));return 0<u.length&&function(e,n){throw new Error("All values need to be of type: "+n+". Keys ("+bu(e).join(", ")+") were not.")}(u,t.label),r}}(hu,e,{validate:g,label:"function"})}function wu(e){function n(){return e.stopPropagation()}function t(){return e.preventDefault()}var o,u,i=Ve.fromDom(function(e){if(wn()&&r(e.target)){var n=Ve.fromDom(e.target);if(gn(n)&&function(e){return r(e.dom.shadowRoot)}(n)&&e.composed&&e.composedPath){var t=e.composedPath();if(t)return j(t)}}return q.from(e.target)}(e).getOr(e.target)),c=(o=t,u=n,function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return o(u.apply(null,e))});return{target:i,x:e.clientX,y:e.clientY,stop:n,prevent:t,kill:c,raw:e}}function yu(e,n,t){return o=n,u=Kl,i=t,c=function(e){u(e)&&i(wu(e))},(r=e).dom.addEventListener(o,c,!1),{unbind:b($l,r,o,c,!1)};var r,o,u,i,c}function Cu(e){return void 0!==e.dom.classList}function Su(e,n){Cu(e)?e.dom.classList.add(n):function(e,n){return r=n,Bn(e,"class",(void 0===(t=En(e,"class"))||""===t?[]:t.split(" ")).concat([r]).join(" ")),1;var t,r}(e,n)}function Tu(e,n){return Cu(e)&&e.dom.classList.contains(n)}function xu(e){var n=e.replace(/\./g,"-");return{resolve:function(e){return n+"-"+e}}}function Ru(e){return kn(e,"[contenteditable]")}function Du(e,n){return void 0===n&&(n=!1),!He().browser.isIE()&&Cn(e)?e.dom.isContentEditable:Ru(e).fold(u(n),(function(e){return"true"===Ql(e)}))}function Ou(e){O(dn(e.parent(),"."+ea),Xt)}function Au(e,n,t){var r=e.origin();O(n,(function(n){n.each((function(n){var o=t(r,n);Su(o,ea),Kt(e.parent(),o)}))}))}function ku(e,n){var t;Ou(e),e.isResizable(n)&&function(e,n,t,r,o){var u,i,c,l,a,f=xr(t),s=n.isResizable,m=0<r.length?ro.positions(r,t):[],d=0<m.length?(u=s,N(e.all,(function(e,n){return u(e.element)?[n]:[]}))):[],g=k(m,(function(e,n){return x(d,(function(e){return n===e}))}));i=n,c=g,l=f,a=hr(t),Au(i,c,(function(e,n){var t,r,o,u,i,c=(t=n.row,r=l.left-e.left,o=n.y-e.top,u=a,Vn(i=Ve.fromTag("div"),{position:"absolute",left:r+"px",top:o-3.5+"px",height:"7px",width:u+"px"}),Mn(i,{"data-row":t,role:"presentation"}),i);return Su(c,na),c}));var p,b,h,v,w,y,C,S=0<o.length?uo.positions(o,t):[],T=0<S.length?(b=s,h=[],R((p=e).grid.columns,(function(e){Gt.getColumnAt(p,e).map((function(e){return e.element})).forall(b)&&h.push(e)})),k(h,(function(e){return z(Gt.filterItems(p,(function(n){return n.column===e})),(function(e){return b(e.element)}))}))):[],D=k(S,(function(e,n){return x(T,(function(e){return n===e}))}));v=n,w=D,y=f,C=Sr(t),Au(v,w,(function(e,n){var t,r,o,u,i,c=(t=n.col,r=n.x-e.left,o=y.top-e.top,u=C,Vn(i=Ve.fromTag("div"),{position:"absolute",left:r-3.5+"px",top:o+"px",height:u+"px",width:"7px"}),Mn(i,{"data-column":t,role:"presentation"}),i);return Su(c,ta),c}))}(t=Gt.fromTable(n),e,n,wr(t),vr(t))}function Iu(e,n){O(dn(e.parent(),"."+ea),n)}function Bu(e){Iu(e,(function(e){Hn(e,"display","none")}))}function Mu(e){Iu(e,(function(e){Hn(e,"display","block")}))}function Eu(e){function n(e,n){return q.from(En(e,n))}var t,r,u,i,c,l,a=(i=pu({drag:gu(["xDelta","yDelta","target"])}),c=q.none(),(l={mutate:function(e,n){u.trigger.drag(e,n)},events:(u=pu({drag:gu(["xDelta","yDelta"])})).registry}).events.drag.bind((function(e){c.each((function(n){i.trigger.drag(e.xDelta,e.yDelta,n)}))})),{assign:function(e){c=q.some(e)},get:function(){return c},mutate:l.mutate,events:i.registry}),f=(r=void 0!==(t={}).mode?t.mode:Jl,function(e,n,t){function r(){g.stop(),a.isOn()&&(a.off(),l.trigger.stop())}var u,i,c=!1,l=pu({start:gu([]),stop:gu([])}),a=function(){var e,n,t={onEvent:o,reset:o,events:pu({move:gu(["info"])}).registry},r=(e=q.none(),{onEvent:function(t,r){r.extract(t).each((function(t){var o=r,u=t,i=e.map((function(e){return o.compare(e,u)}));e=q.some(u),i.each((function(e){n.trigger.move(e)}))}))},reset:function(){e=q.none()},events:(n=pu({move:gu(["info"])})).registry}),u=t;return{on:function(){u.reset(),u=r},off:function(){u.reset(),u=t},isOn:function(){return u===r},onEvent:function(e,n){u.onEvent(e,n)},events:r.events}}(),f=(u=r,i=null,{cancel:m,throttle:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];m(),i=setTimeout((function(){i=null,u.apply(null,e)}),200)}});function m(){s(i)||(clearTimeout(i),i=null)}function d(e){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];c&&e.apply(null,n)}}a.events.move.bind((function(t){n.mutate(e,t.info)}));var g=n.sink(Gl({forceDrop:r,drop:d(r),move:d((function(e){f.cancel(),a.onEvent(e,n)})),delayDrop:d(f.throttle)}),t);return{element:g.element,go:function(e){g.start(e),a.on(),l.trigger.start()},on:function(){c=!0},off:function(){c=!1},destroy:function(){g.destroy()},events:l.registry}}(a,r,t)),m=q.none();function d(e,n){return Jn(e,n)-$n(e,"data-initial-"+n,0)}function g(n,t){w.trigger.startAdjust(),a.assign(n),Bn(n,"data-initial-"+t,Jn(n,t)),Su(n,ra),Hn(n,"opacity","0.2"),f.go(e.parent())}function p(n){return ce(n,e.view())}a.events.drag.bind((function(e){n(e.target,"data-row").each((function(n){var t=Jn(e.target,"top");Hn(e.target,"top",t+e.yDelta+"px")})),n(e.target,"data-column").each((function(n){var t=Jn(e.target,"left");Hn(e.target,"left",t+e.xDelta+"px")}))})),f.events.stop.bind((function(){a.get().each((function(t){m.each((function(r){n(t,"data-row").each((function(e){var n=d(t,"top");_t(t,"data-initial-top"),w.trigger.adjustHeight(r,n,parseInt(e,10))})),n(t,"data-column").each((function(e){var n=d(t,"left");_t(t,"data-initial-left"),w.trigger.adjustWidth(r,n,parseInt(e,10))})),ku(e,r)}))}))}));var h=yu(e.parent(),"mousedown",(function(e){Tu(e.target,na)&&g(e.target,"top"),Tu(e.target,ta)&&g(e.target,"left")})),v=yu(e.view(),"mouseover",(function(n){kn(n.target,"table",p).filter(Du).fold((function(){Cn(n.target)&&Ou(e)}),(function(n){m=q.some(n),ku(e,n)}))})),w=pu({adjustHeight:gu(["table","delta","row"]),adjustWidth:gu(["table","delta","column"]),startAdjust:gu([])});return{destroy:function(){h.unbind(),v.unbind(),f.destroy(),Ou(e)},refresh:function(n){ku(e,n)},on:f.on,off:f.off,hideBars:b(Bu,e),showBars:b(Mu,e),events:w.registry}}function Pu(e,n){return e.fire("newrow",{node:n})}function Nu(e,n){return e.fire("newcell",{node:n})}function zu(e,n,t){e.fire("TableModified",K(K({},t),{table:n}))}function Lu(e){return e.getParam("table_sizing_mode","auto")}function _u(e){return e.getParam("table_responsive_width")}function Wu(e){return e.getParam("table_border_widths",la,"array")}function ju(e){return e.getParam("table_border_styles",aa,"array")}function Fu(e){return e.getParam("table_default_attributes",fa,"object")}function Hu(e){return e.getParam("table_default_styles",function(e){var n;if(ma(e)){var t=e.dom,r=null!==(n=t.getParent(e.selection.getStart(),t.isBlock))&&void 0!==n?n:e.getBody(),o=Xr(Ve.fromDom(r));return K(K({},ca),{width:o+"px"})}return da(e)?se(ca,(function(e,n){return"width"!==n})):ca}(e),"object")}function Vu(e){return e.getParam("table_cell_advtab",!0,"boolean")}function qu(e){return e.getParam("table_row_advtab",!0,"boolean")}function Uu(e){return e.getParam("table_advtab",!0,"boolean")}function Gu(e){return e.getParam("table_style_by_css",!1,"boolean")}function $u(e){return e.getParam("table_cell_class_list",[],"array")}function Ku(e){return e.getParam("table_class_list",[],"array")}function Xu(e){return"relative"===Lu(e)||!0===_u(e)}function Yu(e){var n="section",t=e.getParam("table_header_type",n,"string");return T(["section","cells","sectionCells","auto"],t)?t:n}function Ju(e){var n=e.getParam("table_column_resizing",sa,"string");return M(["preservetable","resizetable"],(function(e){return e===n})).getOr(sa)}function Qu(e){return"preservetable"===Ju(e)}function Zu(e){return"resizetable"===Ju(e)}function ei(e){var n=e.getParam("table_clone_elements");return l(n)?q.some(n.split(/[ ,]/)):Array.isArray(n)?q.some(n):q.none()}function ni(e){return e.getParam("table_background_color_map",[],"array")}function ti(e){return e.getParam("table_border_color_map",[],"array")}function ri(e,n){return(Xu(e)?Al:ma(e)?Ol:Dl)(n)}function oi(e){_t(e,"width")}function ui(e){return"false"!==En(e,"data-mce-resize")}function ii(e,n){return{element:e,offset:n}}function ci(e,n){return(e.property().isText(n)?e.property().getText(n):e.property().children(n)).length}function li(e,n){1===Kn(e,"colspan")&&po(e).bind((function(e){return n=["fixed","relative","empty"],q.from(co.exec(e)).bind((function(e){var t=Number(e[1]),r=e[2],o=r;return x(n,(function(e){return x(io[e],(function(e){return o===e}))}))?q.some({value:t,unit:r}):q.none()}));var n})).each((function(t){var r=t.value/2;wo(e,r,t.unit),wo(n,r,t.unit)}))}function ai(e){return z(e,(function(e){return Sa(e.element)}))}function fi(e){var n="thead"===e.section,t=zn(Ta(e.cells),"th");return n||t?{type:"header",subType:n&&t?"sectionCells":n?"section":"cells"}:"tfoot"===e.section?{type:"footer"}:{type:"body"}}function si(e,n,t){return we(t(e.element,n),!0,e.isLocked)}function mi(e,n){return e.section!==n?ye(e.element,e.cells,n,e.isNew):e}function di(){return{transformRow:mi,transformCell:function(e,n,t){var r,o,u=t(e.element,n);return we("td"!==Ye(u)?(o=ar(r=u,"td"),xt(r,o),kt(o,ln(r)),Xt(r),o):u,e.isNew,e.isLocked)}}}function gi(){return{transformRow:mi,transformCell:si}}function pi(){return{transformRow:function(e,n){return mi(e,"thead"===n?"tbody":n)},transformCell:si}}function bi(e,n,t,r){t===r?_t(e,n):Bn(e,n,t)}function hi(e,n,t){F(mn(e,n)).fold((function(){return Dt(e,t)}),(function(e){return Rt(e,t)}))}function vi(e,n){if(0===e.length)return 0;var t=e[0];return E(e,(function(e){return!n(t.element,e.element)})).getOr(e.length)}function wi(e,n,t){var r=[];O(e.colgroups,(function(o){for(var u=[],i=0;i<e.grid.columns;i++){var c=Gt.getColumnAt(e,i).map((function(e){return we(e.element,t,!1)})).getOrThunk((function(){return we(n.colGap(),!0,!1)}));u.push(c)}r.push(ye(o.element,u,"colgroup",t))}));for(var o=0;o<e.grid.rows;o++){for(var u=[],i=0;i<e.grid.columns;i++){var c=Gt.getAt(e,o,i).map((function(e){return we(e.element,t,e.isLocked)})).getOrThunk((function(){return we(n.gap(),!0,!1)}));u.push(c)}var l=e.all[o],a=ye(l.element,u,l.section,t);r.push(a)}return r}function yi(e){return function(e,n){var t=D(e,(function(e){return D(e.cells,w)}));return D(e,(function(r,o){var u=N(r.cells,(function(r,u){if(!1!==t[o][u])return[];var i,c,l,a,f,s,m,d,g=(l=u,a=n,d="colgroup"===(m=(i=e)[c=o]).section,{colspan:vi(m.cells.slice(l),a),rowspan:d?1:vi((f=i.slice(c),s=l,D(f,(function(e){return ft(e,s)}))),a)});return function(e,n,r,o){for(var u=e;u<e+r;u++)for(var i=n;i<n+o;i++)t[u][i]=!0}(o,u,g.rowspan,g.colspan),[{element:r.element,rowspan:g.rowspan,colspan:g.colspan,isNew:r.isNew}]}));return{element:r.element,cells:u,section:r.section,isNew:r.isNew}}))}(e,ce)}function Ci(e,n){return H(e.all,(function(e){return M(e.cells,(function(e){return ce(n,e.element)}))}))}function Si(e,n,t){var r=Ln(D(n.selection,(function(n){return Zn(n).bind((function(n){return Ci(e,n)})).filter(t)})));return Wn(0<r.length,r)}function Ti(e,n,t,r,o){return function(u,i,c,l,a){var f=Gt.fromTable(i),s=q.from(null==a?void 0:a.section).getOrThunk(hl);return n(f,c).map((function(n){var t=wi(f,l,!1),r=e(t,n,ce,o(l),s),u=bt(r.grid);return{info:n,grid:yi(r.grid),cursor:r.cursor,lockedColumns:u}})).bind((function(e){var n=function(e,n){function t(n,t){0<n.length?function(n,t){var u,i,c;kt((It(c=On(u=e,i=t).getOrThunk((function(){var e=Ve.fromTag(i,nn(u).dom);return"thead"===i?hi(u,"caption,colgroup",e):"colgroup"===i?hi(u,"caption",e):Kt(u,e),e}))),c),("colgroup"===t?function(e){return N(e,(function(e){return D(e.cells,(function(e){return bi(e.element,"span",e.colspan,1),e.element}))}))}:function(e){return D(e,(function(e){e.isNew&&r.push(e.element);var n=e.element;return It(n),O(e.cells,(function(e){e.isNew&&o.push(e.element),bi(e.element,"colspan",e.colspan,1),bi(e.element,"rowspan",e.rowspan,1),Kt(n,e.element)})),n}))})(n))}(n,t):On(e,t).each(Xt)}var r=[],o=[],u=[],i=[],c=[],l=[];return O(n,(function(e){switch(e.section){case"thead":u.push(e);break;case"tbody":i.push(e);break;case"tfoot":c.push(e);break;case"colgroup":l.push(e)}})),t(l,"colgroup"),t(u,"thead"),t(i,"tbody"),t(c,"tfoot"),{newRows:r,newCells:o}}(i,e.grid),o=q.from(null==a?void 0:a.sizing).getOrThunk((function(){return Dl(i)})),c=q.from(null==a?void 0:a.resize).getOrThunk(cu);return t(i,e.grid,e.info,{sizing:o,resize:c,section:s}),r(i),ku(u,i),_t(i,Ut),0<e.lockedColumns.length&&Bn(i,Ut,e.lockedColumns.join(",")),q.some({cursor:e.cursor,newRows:n.newRows,newCells:n.newCells})}))}}function xi(e,n){return Si(e,n,y).map((function(e){return{cells:e,generators:n.generators,clipboard:n.clipboard}}))}function Ri(e,n){return Si(e,n,y)}function Di(e,n){return Si(e,n,(function(e){return!e.isLocked}))}function Oi(e,n){return z(n,(function(n){return Ci(e,n).exists((function(e){return!e.isLocked}))}))}function Ai(e,n){return n.mergable.filter((function(n){return Oi(e,n.cells)}))}function ki(e,n){return n.unmergable.filter((function(n){return Oi(e,n)}))}function Ii(e,n,t,r){for(var o=dt(e).rows,u=!0,i=0;i<o.length;i++)for(var c=0;c<mt(o[0]);c++){var l=o[i],a=ft(l,c),f=t(a.element,n);!0===f&&!1===u?at(l,c,we(r(),!0,a.isLocked)):!0===f&&(u=!1)}return e}function Bi(e,n){return{rowDelta:0,colDelta:mt(e[0])-mt(n[0])}}function Mi(e,n){return{rowDelta:e.length-n.length,colDelta:0}}function Ei(e,n,t,r){var o="colgroup"===n.section?t.col:t.cell;return R(e,(function(e){return we(o(),!0,r(e))}))}function Pi(e,n,t,r){var o=e[e.length-1];return e.concat(R(n,(function(){var e="colgroup"===o.section?t.colgroup:t.row,n=gt(o,e,i),u=Ei(n.cells.length,n,t,(function(e){return Ke(r,e.toString())}));return qt(n,u)})))}function Ni(e,n,t,r){return D(e,(function(e){var o=Ei(n,e,t,w);return ct(e,r,o)}))}function zi(e,n,t){var r=n.colDelta<0?Ni:i,o=n.rowDelta<0?Pi:i,u=bt(e),c=mt(e[0]),l=x(u,(function(e){return e===c-1})),a=r(e,Math.abs(n.colDelta),t,l?c-1:c),f=bt(a);return o(a,Math.abs(n.rowDelta),t,L(f,y))}function Li(e,n,t){return k(t,(function(t){return t>=e.column&&t<=mt(n[0])+e.column}))}function _i(e,n,t,r,o){var u=e,i=o,c=r.cell;0<u&&u<n[0].cells.length&&O(n,(function(e){var n=e.cells[u-1],t=e.cells[u];i(t.element,n.element)&&at(e,u,we(c(),!0,t.isLocked))}));var l=zi(t,Mi(t,n),r);return D(zi(n,Mi(n,l),r),(function(n,t){return ct(n,e,l[t].cells)}))}function Wi(e,n,t,r,o){!function(e,n,t,r){var o,u,i=dt(e).rows;0<n&&n<i.length&&(o=i[n-1].cells,u=t,O(B(o,(function(e,n){return x(e,(function(e){return u(e.element,n.element)}))?e:e.concat([n])}),[]),(function(e){for(var o=q.none(),u=n;u<i.length;u++)for(var c=0;c<mt(i[0]);c++)!function(n){var c=i[u],l=ft(c,n);t(l.element,e.element)&&(o=o.isNone()?q.some(r()):o).each((function(e){at(c,n,we(e,!0,l.isLocked))}))}(c)})))}(n,e,o,r.cell);var u,i,c=bt(n),l=Bi(n,t),a=zi(n,K(K({},l),{colDelta:l.colDelta-c.length}),r),f=dt(a),s=f.cols,m=f.rows,d=bt(a),g=Bi(t,n),p=K(K({},g),{colDelta:g.colDelta+d.length}),b=zi((u=r,i=d,D(t,(function(e){return B(i,(function(n,t){return lt(n,t,Ei(1,e,u,y)[0])}),e)}))),p,r);return s.concat(m.slice(0,e)).concat(b).concat(m.slice(e,m.length))}function ji(e,n,t,r,o){var u,i,c,l,a=dt(e),f=a.rows,s=a.cols,m=f.slice(0,n),d=f.slice(n),g=(u=f[t],i=function(e,t){return 0<n&&n<f.length&&r(st(f[n-1],t),st(f[n],t))?ft(f[n],t):we(o(e.element,r),!0,e.isLocked)},c=r,l=o,gt(u,(function(e){return l(e,c)}),i));return s.concat(m).concat([g]).concat(d)}function Fi(e,n,t,r,o){return D(e,(function(e){var u,i,c=0<n&&n<mt(e)&&r(st(e,n-1),st(e,n)),l=(u=e.section,i=o,"colgroup"!==u&&c?ft(e,n):we(i(ft(e,t).element,r),!0,!1));return lt(e,n,l)}))}function Hi(e,n,t,r){return void 0!==st((u=e)[i=n],t)&&0<i&&r(st(u[i-1],t),st(u[i],t))||(o=e[n],0<t&&r(st(o,t-1),st(o,t)));var o,u,i}function Vi(e,n,t,r){function o(e){return("row"===e?Yn:Xn)(n)?e+"group":e}return e?Sa(n)?o(t):null:r&&Sa(n)?o("row"===t?"col":"row"):null}function qi(e,n,t){return we(t(e.element,n),!0,e.isLocked)}function Ui(e,n,t,r,o,u,i){return D(e,(function(e,c){return a=function(e,l){if(f=e,x(n,(function(e){return t(f.element,e.element)}))){var a=i(e,c,l)?o(e,t,r):e;return u(a,c,l).each((function(e){var n=a.element;ae({scope:q.from(e)},(function(e,t){e.fold((function(){_t(n,t)}),(function(e){In(n.dom,t,e)}))}))})),a}return e;var f},f=D((l=e).cells,a),ye(l.element,f,l.section,l.isNew);var l,a,f}))}function Gi(e,n,t){return N(e,(function(r,o){return Hi(e,o,n,t)?[]:[ft(r,n)]}))}function $i(e,n,t,r,o){var u,c,l,a,f=dt(e).rows,s=N(n,(function(e){return Gi(f,e,r)})),m=D(e,(function(e){return ai(e.cells)})),d=(u=s,z(c=m,i)&&ai(u)?y:function(e,n,t){return!("th"===Ye(e.element)&&c[n])}),g=(l=t,a=m,function(e,n){return q.some(Vi(l,e.element,"row",a[n]))});return Ui(e,s,r,o,qi,g,d)}function Ki(e,n,t,r){var o=dt(e).rows;return Ui(e,D(n,(function(e){return ft(o[e.row],e.column)})),t,r,qi,q.none,y)}function Xi(e){return B(e,(function(e,n){return x(e,(function(e){return e.column===n.column}))?e:e.concat([n])}),[]).sort((function(e,n){return e.column-n.column}))}function Yi(e){return"tr"===Ye(e)||Ba(e)}function Ji(e){return{element:e,colspan:$n(e,"colspan",1),rowspan:$n(e,"rowspan",1)}}function Qi(e){return Pn(e,"scope").map((function(e){return e.substr(0,3)}))}function Zi(e){return n=e,t=Ea.property().name(n),T(Ma,t);var n,t}function ec(e){return n=e,T(["ol","ul"],Ea.property().name(n));var n}function nc(e){return Du(e,!0)}function tc(e){0===et(e).length&&Xt(e)}function rc(e,n){return{grid:e,cursor:n}}function oc(e,n,t){var r,o,u,i,c,l=(r=n,o=t,c=dt(e).rows,q.from(null===(i=null===(u=c[r])||void 0===u?void 0:u.cells[o])||void 0===i?void 0:i.element).filter(nc).orThunk((function(){return H(c,(function(e){return H(e.cells,(function(e){var n=e.element;return Wn(nc(n),n)}))}))})));return rc(e,l)}function uc(e){return B(e,(function(e,n){return x(e,(function(e){return e.row===n.row}))?e:e.concat([n])}),[]).sort((function(e,n){return e.row-n.row}))}function ic(e,n){return function(t,r,o,u,c){return oc(function(e,n,t,r,o,u,c){var l=dt(e),a=l.cols,f=l.rows,s=f[n[0]],m=N(n,(function(e){return r=o,N((n=f)[t=e].cells,(function(e,o){return Hi(n,t,o,r)?[]:[e]}));var n,t,r})),d=D(s.cells,(function(e,n){return ai(Gi(f,n,o))})),g=X([],f,!0);O(n,(function(e){g[e]=c.transformRow(f[e],t)}));var p,b,h,v,w=a.concat(g),C=(p=s,z(b=d,i)&&ai(p.cells)?y:function(e,n,t){return!("th"===Ye(e.element)&&b[t])}),S=(h=r,v=d,function(e,n,t){return q.some(Vi(h,e.element,"col",v[t]))});return Ui(w,m,o,u,c.transformCell,S,C)}(t,D(uc(r),(function(e){return e.row})),e,n,o,u.replaceOrInit,c),r[0].row,r[0].column)}}function cc(e,n,t){var r,o=(r=t.section,ot(e,(function(){return r})));return wi(Gt.generate(o),n,!0)}function lc(e,n,t,r){var o=r.sizing,u=Gt.generate(n);nu(u,o.getWidths(u,o),o)}function ac(e,n,t,r){var o=t,u=r.sizing,i=r.resize,c=Gt.generate(n),l=u.getWidths(c,u),a=u.pixelWidth(),f=i.calcRedestributedWidths(l,a,o.pixelDelta,u.isRelative),s=f.newSizes,m=f.delta;nu(c,s,u),u.adjustTableWidth(m)}function fc(e,n){return x(n,(function(e){return 0===e.column&&e.isLocked}))}function sc(e,n){return x(n,(function(n){return n.column+n.colspan>=e.grid.columns&&n.isLocked}))}function mc(e,n){var t=vr(e);return B(Xi(n),(function(e,n){return e+t[n.column].map(hr).getOr(0)}),0)}function dc(e){return function(n,t){return Ri(n,t).filter((function(t){return!(e?fc:sc)(n,t)})).map((function(e){return{details:e,pixelDelta:mc(n,e)}}))}}function gc(e){return function(n,t){return xi(n,t).filter((function(t){return!(e?fc:sc)(n,t.cells)}))}}function pc(e,n){var t=Gt.fromTable(e);return Ri(t,n).bind((function(e){var n=e[e.length-1],r=e[0].column,o=n.column+n.colspan,u=P(D(t.all,(function(e){return k(e.cells,(function(e){return e.column>=r&&e.column<o}))})));return Ta(u)})).getOr("")}function bc(e,n){return Ri(Gt.fromTable(e),n).bind(Ta).getOr("")}function hc(e,n,t,r){return R(e,(function(e){return function(e,n,t,r){for(var o=Ve.fromTag("tr"),u=0;u<e;u++){var i=r<n||u<t?Ve.fromTag("th"):Ve.fromTag("td");u<t&&Bn(i,"scope","row"),r<n&&Bn(i,"scope","col"),Kt(i,Ve.fromTag("br")),Kt(o,i)}return o}(n,t,r,e)}))}function vc(e,n){e.selection.select(n.dom,!0),e.selection.collapse(!0)}function wc(e,n,t,r,o){var u=Hu(e),i={styles:u,attributes:Fu(e),colGroups:e.getParam("table_use_colgroups",!1,"boolean")};return e.undoManager.ignore((function(){var u=function(e,n,t,r,o,u){void 0===u&&(u=cf);var i,c,l=Ve.fromTag("table"),a="cells"!==o;Vn(l,u.styles),Mn(l,u.attributes),u.colGroups&&Kt(l,(i=n,c=Ve.fromTag("colgroup"),R(i,(function(){return Kt(c,Ve.fromTag("col"))})),c));var f,s=Math.min(e,t);a&&0<t&&(f=Ve.fromTag("thead"),Kt(l,f),kt(f,hc(t,n,"sectionCells"===o?s:0,r)));var m=Ve.fromTag("tbody");return Kt(l,m),kt(m,hc(a?e-s:e,n,a?0:t,r)),l}(t,n,o,r,Yu(e),i);Bn(u,"data-mce-id","__mce");var c,l,a,f=(c=u,l=Ve.fromTag("div"),a=Ve.fromDom(c.dom.cloneNode(!0)),Kt(l,a),l.dom.innerHTML);e.insertContent(f),e.addVisual()})),An(qo(e),'table[data-mce-id="__mce"]').map((function(n){var t,r,o;return ma(e)?pa(n):da(e)?ba(n):(Xu(e)||(t=u.width,l(t)&&-1!==t.indexOf("%")))&&ga(n),Xo(n),_t(n,"data-mce-id"),r=e,O(dn(n,"tr"),(function(e){Pu(r,e.dom),O(dn(e,"th,td"),(function(e){Nu(r,e.dom)}))})),o=e,An(n,"td,th").each(b(vc,o)),n.dom})).getOr(null)}function yc(e,n,t,r,o){function u(e){return p(e)&&0<e}if(void 0===r&&(r={}),u(n)&&u(t)){var i=r.headerRows||0;return wc(e,t,n,r.headerColumns||0,i)}return console.error(o),null}function Cc(e){return function(){return e().fold((function(){return[]}),(function(e){return D(e,(function(e){return e.dom}))}))}}function Sc(e){return function(n){var t=0<n.length?q.some(Vo(n)):q.none();e(t)}}function Tc(e,n,t){var r=$n(e,n,1);1===t||r<=1?_t(e,n):Bn(e,n,Math.min(t,r))}function xc(e,n,t){return function(n,r){for(var o=0;o<r.length;o++){var u=e.getStyle(r[o],t);if((n=void 0===n?u:n)!==u)return""}return n}(void 0,e.select("td,th",n))}function Rc(e,n,t){t&&e.formatter.apply("align"+t,{},n)}function Dc(e,n){lf.each("left center right".split(" "),(function(t){e.formatter.remove("align"+t,{},n)}))}function Oc(e){return ff.test(t=e)||sf.test(t)?q.some({value:(Ae(n=e,"#")?n.substring("#".length):n).toUpperCase()}):q.none();var n,t}function Ac(e){var n=e.toString(16);return(1===n.length?"0"+n:n).toUpperCase()}function kc(e){return{value:Ac(e.red)+Ac(e.green)+Ac(e.blue)}}function Ic(e,n,t,r){return{red:e,green:n,blue:t,alpha:r}}function Bc(e,n,t,r){return Ic(parseInt(e,10),parseInt(n,10),parseInt(t,10),parseFloat(r))}function Mc(e){var n=e;return{get:function(){return n},set:function(e){n=e}}}function Ec(e){function n(){return t.get().each(e)}var t=Mc(q.none());return{clear:function(){n(),t.set(q.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(e){n(),t.set(q.some(e))}}}function Pc(){var e=Ec(o);return K(K({},e),{on:function(n){return e.get().each(n)}})}function Nc(e){return be(e,"menu")}function zc(e,n){return function(t){var r;e.execCommand("mceTableApplyCellStyle",!1,((r={})[n]=t,r))}}function Lc(e,n,t,r,o){return function(u){return u(pf(e,n,t,r,o))}}function _c(e,n,t){var r=D(n,(function(e){return{text:e.title,value:"#"+Oc(n=e.value).orThunk((function(){return function(e){if("transparent"===e)return q.some(Ic(0,0,0,0));var n=mf.exec(e);if(null!==n)return q.some(Bc(n[1],n[2],n[3],"1"));var t=df.exec(e);return null!==t?q.some(Bc(t[1],t[2],t[3],t[4])):q.none()}(n).map(kc)})).getOrThunk((function(){var e=document.createElement("canvas");e.height=1,e.width=1;var t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),t.fillStyle="#FFFFFF",t.fillStyle=n,t.fillRect(0,0,1,1);var r=t.getImageData(0,0,1,1).data;return kc(Ic(r[0],r[1],r[2],r[3]))})).value,type:"choiceitem"};var n}));return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:0<r.length?r:void 0,allowCustomColors:!1},onAction:function(n){var r,o="remove"===n.value?"":n.value;e.execCommand("mceTableApplyCellStyle",!1,((r={})[t]=o,r))}}]}function Wc(e){return function(){var n=e.queryCommandValue("mceTableRowType");e.execCommand("mceTableRowType",!1,{type:"header"===n?"body":"header"})}}function jc(e){return function(){var n=e.queryCommandValue("mceTableColType");e.execCommand("mceTableColType",!1,{type:"th"===n?"td":"th"})}}function Fc(e){return hf.concat((0<(n=gf($u(e))).length?q.some({name:"class",type:"listbox",label:"Class",items:n}):q.none()).toArray());var n}function Hc(e,n){var t=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""}].concat(gf(ju(e)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===n?[{name:"borderwidth",type:"input",label:"Border width"}].concat(t):t}}function Vc(e){return function(n,t){var r=n.dom;return{setAttrib:function(n,o){e&&!o||r.setAttrib(t,n,o)},setStyle:function(n,o){e&&!o||r.setStyle(t,n,o)},setFormat:function(r,o){e&&!o||(""===o?n.formatter.remove(r,{value:null},t,!0):n.formatter.apply(r,{value:o},t))}}}}function qc(e){return function(n){return Ae(n,"rgb")?e.toHex(n):n}}function Uc(e,n){var t=Ve.fromDom(n);return{borderwidth:Un(t,"border-width").getOr(""),borderstyle:Un(t,"border-style").getOr(""),bordercolor:Un(t,"border-color").map(qc(e)).getOr(""),backgroundcolor:Un(t,"background-color").map(qc(e)).getOr("")}}function Gc(e){var n=e[0];return O(e.slice(1),(function(e){O(Ue(n),(function(t){ae(e,(function(e,r){var o=n[t];""!==o&&t===r&&o!==e&&(n[t]="")}))}))})),n}function $c(e,n,t,r){return M(e,(function(e){return!d(t.formatter.matchNode(r,n+e))})).getOr("")}function Kc(e,n){var t=Gt.fromTable(e);return D(k(Gt.justCells(t),(function(e){return x(n,(function(n){return ce(e.element,n)}))})),(function(e){return{element:e.element.dom,column:Gt.getColumnAt(t,e.column).map((function(e){return e.element.dom}))}}))}function Xc(e,n,t,r){var o=r.getData();r.close(),e.undoManager.transact((function(){var r,u=e,i=n,c=t,l=se(r=o,(function(e,n){return c[n]!==e}));0<ge(l)&&1<=i.length&&tt(i[0]).each((function(e){var n,t,o,c=Kc(e,i),a=0<ge(se(l,(function(e,n){return"scope"!==n&&"celltype"!==n}))),f=Ke(l,"celltype");(a||Ke(l,"scope"))&&(n=u,t=r,o=1===c.length,O(c,(function(e){var r,u,i,c,l,a,f=e.element,s=o?vf.normal(n,f):vf.ifTruthy(n,f),m=e.column.map((function(e){return o?vf.normal(n,e):vf.ifTruthy(n,e)})).getOr(s),d=t;(r=s).setAttrib("scope",d.scope),r.setAttrib("class",d.class),r.setStyle("height",Ko(d.height)),m.setStyle("width",Ko(d.width)),Vu(n)&&((u=s).setFormat("tablecellbackgroundcolor",(i=t).backgroundcolor),u.setFormat("tablecellbordercolor",i.bordercolor),u.setFormat("tablecellborderstyle",i.borderstyle),u.setFormat("tablecellborderwidth",Ko(i.borderwidth))),o&&(Dc(n,f),c=n,l=f,lf.each("top middle bottom".split(" "),(function(e){c.formatter.remove("valign"+e,{},l)}))),t.halign&&Rc(n,f,t.halign),!t.valign||(a=t.valign)&&n.formatter.apply("valign"+a,{},f)}))),f&&u.execCommand("mceTableCellType",!1,{type:r.celltype,no_events:!0}),zu(u,e.dom,{structure:f,style:a})})),e.focus()}))}function Yc(e,n){var t,r,o,u,i,c=Nl(n);0!==c.length&&(r=e,t=Gc(tt((o=c)[0]).map((function(e){return D(Kc(e,o),(function(e){return t=r,o=e.element,u=Vu(r),i=e.column,c=t.dom,l=i.getOr(o),K({width:n(l,"width"),height:n(o,"height"),scope:c.getAttrib(o,"scope"),celltype:o.nodeName.toLowerCase(),class:c.getAttrib(o,"class",""),halign:wf(t,o),valign:yf(t,o)},u?Uc(c,o):{});function n(e,n){return c.getStyle(e,n)||c.getAttrib(e,n)}var t,o,u,i,c,l}))})).getOrDie()),u={type:"tabpanel",tabs:[{title:"General",name:"general",items:Fc(e)},Hc(e,"cell")]},i={type:"panel",items:[{type:"grid",columns:2,items:Fc(e)}]},e.windowManager.open({title:"Cell Properties",size:"normal",body:Vu(e)?u:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:t,onSubmit:b(Xc,e,c,t)}))}function Jc(e){return Cf.concat((0<(n=gf(e.getParam("table_row_class_list",[],"array"))).length?q.some({name:"class",type:"listbox",label:"Class",items:n}):q.none()).toArray());var n}function Qc(e,n,t,r){var o=r.getData();r.close(),e.undoManager.transact((function(){var r,u,i,c,l,a,f,s=e,m=n,d=t,g=se(r=o,(function(e,n){return d[n]!==e}));0<ge(g)&&(u=Ke(g,"type"),(i=!u||1<ge(g))&&(c=s,l=r,a=d,f=1===m.length,O(m,(function(e){var n,t,r,o=f?vf.normal(c,e):vf.ifTruthy(c,e),u=l;(n=o).setAttrib("class",u.class),n.setStyle("height",Ko(u.height)),qu(c)&&((t=o).setStyle("background-color",(r=l).backgroundcolor),t.setStyle("border-color",r.bordercolor),t.setStyle("border-style",r.borderstyle)),l.align!==a.align&&(Dc(c,e),Rc(c,e,l.align))}))),u&&s.execCommand("mceTableRowType",!1,{type:r.type,no_events:!0}),tt(Ve.fromDom(m[0])).each((function(e){return zu(s,e.dom,{structure:u,style:i})}))),e.focus()}))}function Zc(e){var n,t,r,o,u,i,c,l=(n=Yo(e),t=Ml.selected,o=(r=Pl(n)).bind((function(e){return tt(e)})).map(rt),_n(r,o,(function(e,n){return k(n,(function(n){return x(Vo(n.dom.cells),(function(n){return"1"===En(n,t)||ce(n,e)}))}))})).getOr([]));0!==l.length&&(u=Gc(D(l,(function(n){return t=e,r=n.dom,o=qu(e),i=t.dom,K({height:i.getStyle(r,"height")||i.getAttrib(r,"height"),class:i.getAttrib(r,"class",""),type:tt(Ve.fromDom(u=r)).map((function(e){var n={selection:Vo(u.cells)};return uf(e,n)})).getOr(""),align:wf(t,r)},o?Uc(i,r):{});var t,r,o,u,i}))),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:Jc(e)},Hc(e,"row")]},c={type:"panel",items:[{type:"grid",columns:2,items:Jc(e)}]},e.windowManager.open({title:"Row Properties",size:"normal",body:qu(e)?i:c,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:u,onSubmit:b(Qc,e,D(l,(function(e){return e.dom})),u)}))}function el(e,n,t,r){var o=e.dom,u=r.getData(),i=se(u,(function(e,n){return t[n]!==e}));r.close(),""===u.class&&delete u.class,e.undoManager.transact((function(){var t,r,c,l,a;n||(t=parseInt(u.cols,10)||1,r=parseInt(u.rows,10)||1,n=wc(e,t,r,0,0)),0<ge(i)&&(function(e,n,t){var r,o=e.dom,u={},i={};if(u.class=t.class,i.height=Ko(t.height),o.getAttrib(n,"width")&&!Gu(e)?u.width=(r=t.width)?r.replace(/px$/,""):"":i.width=Ko(t.width),Gu(e)?(i["border-width"]=Ko(t.border),i["border-spacing"]=Ko(t.cellspacing)):(u.border=t.border,u.cellpadding=t.cellpadding,u.cellspacing=t.cellspacing),Gu(e)&&n.children)for(var c=0;c<n.children.length;c++)Sf(o,n.children[c],{"border-width":Ko(t.border),padding:Ko(t.cellpadding)}),Uu(e)&&Sf(o,n.children[c],{"border-color":t.bordercolor});Uu(e)&&(i["background-color"]=t.backgroundcolor,i["border-color"]=t.bordercolor,i["border-style"]=t.borderstyle),u.style=o.serializeStyle(K(K({},Hu(e)),i)),o.setAttribs(n,K(K({},Fu(e)),u))}(e,n,u),((c=o.select("caption",n)[0])&&!u.caption||!c&&u.caption)&&e.execCommand("mceTableToggleCaption"),""===u.align?Dc(e,n):Rc(e,n,u.align)),e.focus(),e.addVisual(),0<ge(i)&&(a=!(l=Ke(i,"caption"))||1<ge(i),zu(e,n,{structure:l,style:a}))}))}function nl(e,n){var t,r,o,u,i,c,l,a,f,s,m,d,g,p,h,v,w,y,C,S=e.dom,T=(o=Uu(r=e),a=Hu(r),f=Fu(r),s=o?(u=r.dom,{borderstyle:pe(a,"border-style").getOr(""),bordercolor:qc(u)(pe(a,"border-color").getOr("")),backgroundcolor:qc(u)(pe(a,"background-color").getOr(""))}):{},K(K(K(K(K(K({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),a),f),s),(l=a["border-width"],Gu(r)&&l?{border:l}:pe(f,"border").fold((function(){return{}}),(function(e){return{border:e}})))),(i=pe(a,"border-spacing").or(pe(f,"cellspacing")).fold((function(){return{}}),(function(e){return{cellspacing:e}})),c=pe(a,"border-padding").or(pe(f,"cellpadding")).fold((function(){return{}}),(function(e){return{cellpadding:e}})),K(K({},i),c))));!1===n?(t=S.getParent(e.selection.getStart(),"table",e.getBody()))?(d=t,g=Uu(m=e),w=m.dom,y=Gu(m)?w.getStyle(d,"border-spacing")||w.getAttrib(d,"cellspacing"):w.getAttrib(d,"cellspacing")||w.getStyle(d,"border-spacing"),C=Gu(m)?xc(w,d,"padding")||w.getAttrib(d,"cellpadding"):w.getAttrib(d,"cellpadding")||xc(w,d,"padding"),T=K({width:w.getStyle(d,"width")||w.getAttrib(d,"width"),height:w.getStyle(d,"height")||w.getAttrib(d,"height"),cellspacing:y,cellpadding:C,border:(p=w,v=Un(Ve.fromDom(h=d),"border-width"),Gu(m)&&v.isSome()?v.getOr(""):p.getAttrib(h,"border")||xc(m.dom,h,"border-width")||xc(m.dom,h,"border")),caption:!!w.select("caption",d)[0],class:w.getAttrib(d,"class",""),align:wf(m,d)},g?Uc(w,d):{})):Uu(e)&&(T.borderstyle="",T.bordercolor="",T.backgroundcolor=""):(T.cols="1",T.rows="1",Uu(e)&&(T.borderstyle="",T.bordercolor="",T.backgroundcolor=""));var x=gf(Ku(e));0<x.length&&T.class&&(T.class=T.class.replace(/\s*mce\-item\-table\s*/g,""));var R,D,O,A,k={type:"grid",columns:2,items:(R=x,D=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],O=e.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],A=0<R.length?[{type:"listbox",name:"class",label:"Class",items:R}]:[],D.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(O).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(A))},I=Uu(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[k]},Hc(e,"table")]}:{type:"panel",items:[k]};e.windowManager.open({title:"Table Properties",size:"normal",body:I,onSubmit:b(el,e,t,T),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:T})}function tl(e){return El(Yo(e),$o(e))}function rl(e,n,t,r,u){function i(e){return tt(e,v)}function c(n){return Pl(Yo(t=e),$o(t)).bind((function(e){return i(e).map((function(t){return n(t,e)}))}));var t}function f(n){e.focus()}function s(e,n){return void 0===n&&(n=!1),c((function(t,o){var u=Qo(r,t,o);e(t,u,n).each(f)}))}function m(){return c((function(n,t){var u,i,c,l=Qo(r,n,t),a=Fo(o,Ve.fromDom(e.getDoc()),q.none());return u=l,i=a,Ri(c=Gt.fromTable(n),u).bind((function(e){var n=yi(N(dt(wi(c,i,!1)).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),(function(e){var n=k(e.cells,(function(e){return!e.isLocked}));return 0<n.length?[K(K({},e),{cells:n})]:[]})));return Wn(0<n.length,n)})).map((function(e){return D(e,(function(e){var n=cr(e.element);return O(e.cells,(function(e){var t=lr(e.element);bi(t,"colspan",e.colspan,1),bi(t,"rowspan",e.rowspan,1),Kt(n,t)})),n}))}))}))}function d(){return c((function(e,n){var t,o;return t=Qo(r,e,n),Di(o=Gt.fromTable(e),t).map((function(e){var n,t,r=e[e.length-1],u=e[0].column,i=r.column+r.colspan,c=function(e,n,t){if(Gt.hasColumns(e)){var r=D(k(Gt.justColumns(e),(function(e){return e.column>=n&&e.column<t})),(function(e){var r=lr(e.element);return Tc(r,"span",t-n),r})),o=Ve.fromTag("colgroup");return kt(o,r),[o]}return[]}(o,u,i),l=(n=u,t=i,D(o.all,(function(e){var r=D(k(e.cells,(function(e){return e.column>=n&&e.column<t})),(function(e){var r=lr(e.element);return Tc(r,"colspan",t-n),r})),o=Ve.fromTag("tr");return kt(o,r),o})));return X(X([],c,!0),l,!0)}))}))}function g(n,t){return t().each((function(t){var o=D(t,lr);c((function(t,u){var i,c,l=Ho(Ve.fromDom(e.getDoc())),a=(i=o,c=l,{selection:Jo(r),clipboard:i,generators:c});n(t,a).each(f)}))}))}function p(e){return function(n,t){return pe(t,"type").each((function(n){s(e(n),t.no_events)}))}}var v=$o(e);ae({mceTableSplitCells:function(){return s(n.unmergeCells)},mceTableMergeCells:function(){return s(n.mergeCells)},mceTableInsertRowBefore:function(){return s(n.insertRowsBefore)},mceTableInsertRowAfter:function(){return s(n.insertRowsAfter)},mceTableInsertColBefore:function(){return s(n.insertColumnsBefore)},mceTableInsertColAfter:function(){return s(n.insertColumnsAfter)},mceTableDeleteCol:function(){return s(n.deleteColumn)},mceTableDeleteRow:function(){return s(n.deleteRow)},mceTableCutCol:function(){return d().each((function(e){u.setColumns(e),s(n.deleteColumn)}))},mceTableCutRow:function(){return m().each((function(e){u.setRows(e),s(n.deleteRow)}))},mceTableCopyCol:function(){return d().each((function(e){return u.setColumns(e)}))},mceTableCopyRow:function(){return m().each((function(e){return u.setRows(e)}))},mceTablePasteColBefore:function(){return g(n.pasteColsBefore,u.getColumns)},mceTablePasteColAfter:function(){return g(n.pasteColsAfter,u.getColumns)},mceTablePasteRowBefore:function(){return g(n.pasteRowsBefore,u.getRows)},mceTablePasteRowAfter:function(){return g(n.pasteRowsAfter,u.getRows)},mceTableDelete:function(){return tl(e).each((function(n){tt(n,v).filter(h(v)).each((function(n){var t,r=Ve.fromText("");Rt(n,r),Xt(n),e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):((t=e.dom.createRng()).setStart(r.dom,0),t.setEnd(r.dom,0),e.selection.setRng(t),e.nodeChanged())}))}))},mceTableCellToggleClass:function(n,t){c((function(n){var o=Nl(r),u=z(o,(function(n){return e.formatter.match("tablecellclass",{value:t},n.dom)}))?e.formatter.remove:e.formatter.apply;O(o,(function(e){return u("tablecellclass",{value:t},e.dom)})),zu(e,n.dom,oa)}))},mceTableToggleClass:function(n,t){c((function(n){e.formatter.toggle("tableclass",{value:t},n.dom),zu(e,n.dom,oa)}))},mceTableToggleCaption:function(){tl(e).each((function(n){tt(n,v).each((function(t){On(t,"caption").fold((function(){var n,r,o=Ve.fromTag("caption");Kt(o,Ve.fromText("Caption")),r=o,an(n=t,0).fold((function(){Kt(n,r)}),(function(e){xt(e,r)})),e.selection.setCursorLocation(o.dom,0)}),(function(r){en("caption")(n)&&ie("td",t).each((function(n){return e.selection.setCursorLocation(n.dom,0)})),Xt(r)})),zu(e,t.dom,ua)}))}))},mceTableSizingMode:function(n,t){return r=t,tl(e).each((function(n){da(e)||ma(e)||Xu(e)||tt(n,v).each((function(n){"relative"!==r||gl(n)?"fixed"!==r||pl(n)?"responsive"!==r||bl(n)||ba(n):pa(n):ga(n),Xo(n),zu(e,n.dom,ua)}))}));var r},mceTableCellType:p((function(e){return"th"===e?n.makeCellsHeader:n.unmakeCellsHeader})),mceTableColType:p((function(e){return"th"===e?n.makeColumnsHeader:n.unmakeColumnsHeader})),mceTableRowType:p((function(e){switch(e){case"header":return n.makeRowsHeader;case"footer":return n.makeRowsFooter;default:return n.makeRowsBody}}))},(function(n,t){return e.addCommand(t,n)})),ae({mceTableProps:b(nl,e,!1),mceTableRowProps:b(Zc,e),mceTableCellProps:b(Yc,e,r)},(function(n,t){return e.addCommand(t,(function(){return n()}))})),e.addCommand("mceInsertTable",(function(n,t){a(t)&&0<Ue(t).length?yc(e,t.rows,t.columns,t.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):nl(e,!0)})),e.addCommand("mceTableApplyCellStyle",(function(n,t){function o(e){return"tablecell"+e.toLowerCase().replace("-","")}var u,c;!a(t)||0!==(u=Nl(r)).length&&(function(e){for(var n in e)if(Ge.call(e,n))return;return 1}(c=se(t,(function(n,t){return e.formatter.has(o(t))&&l(n)})))||(ae(c,(function(n,t){O(u,(function(r){vf.normal(e,r.dom).setFormat(o(t),n)}))})),i(u[0]).each((function(n){return zu(e,n.dom,oa)}))))}))}function ol(e,n){return tt(e,n).bind((function(n){var t=et(n);return E(t,(function(n){return ce(e,n)})).map((function(e){return{index:e,all:t}}))}))}function ul(e,n){var t=e.document.createRange();return t.selectNode(n.dom),t}function il(e,n){var t=e.document.createRange();return Pf(t,n),t}function cl(e,n,t){var r,o=e.document.createRange(),u=o;return n.fold((function(e){u.setStartBefore(e.dom)}),(function(e,n){u.setStart(e.dom,n)}),(function(e){u.setStartAfter(e.dom)})),r=o,t.fold((function(e){r.setEndBefore(e.dom)}),(function(e,n){r.setEnd(e.dom,n)}),(function(e){r.setEndAfter(e.dom)})),o}function ll(e,n,t,r,o){var u=e.document.createRange();return u.setStart(n.dom,t),u.setEnd(r.dom,o),u}function al(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}}function fl(e,n,t){return n(Ve.fromDom(t.startContainer),t.startOffset,Ve.fromDom(t.endContainer),t.endOffset)}function sl(e,n){var t,r,o,i=(t=e,n.match({domRange:function(e){return{ltr:u(e),rtl:q.none}},relative:function(e,n){return{ltr:Y((function(){return cl(t,e,n)})),rtl:Y((function(){return q.some(cl(t,n,e))}))}},exact:function(e,n,r,o){return{ltr:Y((function(){return ll(t,e,n,r,o)})),rtl:Y((function(){return q.some(ll(t,r,o,e,n))}))}}}));return(o=(r=i).ltr()).collapsed?r.rtl().filter((function(e){return!1===e.collapsed})).map((function(e){return Nf.rtl(Ve.fromDom(e.endContainer),e.endOffset,Ve.fromDom(e.startContainer),e.startOffset)})).getOrThunk((function(){return fl(0,Nf.ltr,o)})):fl(0,Nf.ltr,o)}function ml(e,n){return sl(e,n).match({ltr:function(n,t,r,o){var u=e.document.createRange();return u.setStart(n.dom,t),u.setEnd(r.dom,o),u},rtl:function(n,t,r,o){var u=e.document.createRange();return u.setStart(r.dom,o),u.setEnd(n.dom,t),u}})}function dl(e,n){return{parent:u(q.from(e.dom.documentElement).map(Ve.fromDom).getOr(e)),view:u(e),origin:u(no(0,0)),isResizable:n}}function gl(e){return po(e).exists((function(e){return Cl.test(e)}))}function pl(e){return po(e).exists((function(e){return Sl.test(e)}))}function bl(e){return po(e).isNone()}function hl(){return{transformRow:i,transformCell:si}}function vl(e,n){function t(t){if(Yi(t))return Ba((u={element:t}).element)?e.colgroup(u):e.row(u);var o,u,i=(o=n(t),Ia(o.element)?e.col(o):e.cell(o));return r=q.some({item:t,replacement:i}),i}void 0===n&&(n=Ji);var r=q.none();return{getOrInit:function(e,n){return r.fold((function(){return t(e)}),(function(r){return n(e,r.item)?r.replacement:t(e)}))}}}function wl(e){return function(n){function t(t){var o=n.replace(t,e,"td"===e?{scope:null}:{});return r.push({item:t,sub:o}),o}var r=[];return{replaceOrInit:function(e,n){return Yi(e)||Ia(e)?e:(o=e,u=n,M(r,(function(e){return u(e.item,o)})).fold((function(){return t(e)}),(function(r){return n(e,r.item)?r.sub:t(e)})));var o,u}}}}function yl(e){return{unmerge:function(n){var t=Qi(n);return t.each((function(e){return Bn(n,"scope",e)})),function(){var r=e.cell({element:n,colspan:1,rowspan:1});return Gn(r,"width"),Gn(n,"width"),t.each((function(e){return Bn(r,"scope",e)})),r}},merge:function(e){return Gn(e[0],"width"),function(){var n=Ln(D(e,Qi));if(0===n.length)return q.none();var t=n[0],r=["row","col"];return x(n,(function(e){return e!==t&&T(r,e)}))?q.none():q.from(t)}().fold((function(){return _t(e[0],"scope")}),(function(n){return Bn(e[0],"scope",n+"group")})),u(e[0])}}}var Cl=/(\d+(\.\d+)?)%/,Sl=/(\d+(\.\d+)?)px|em/,Tl=en("col"),xl=u(Cl),Rl=en("col"),Dl=function(e){return po(e).fold((function(){return{width:t=Ao(n=e,br),pixelWidth:t,getWidths:function(e,t){return Do(e,n,t)},getCellDelta:r=u(0),singleColumnWidth:u([0]),minCellWidth:r,setElementWidth:o,adjustTableWidth:o,isRelative:!0,label:"none"};var n,t,r}),(function(n){return t=e,r=n,(null!==xl().exec(r)?ko:Io)(t);var t,r}))},Ol=Io,Al=ko,kl=["img","br"],Il=function(e,n){var t=function(e){for(var r=ln(e),o=r.length-1;0<=o;o--){var u=r[o];if(n(u))return q.some(u);var i=t(u);if(i.isSome())return i}return q.none()};return t(e)},Bl={scope:["row","col"]},Ml={selected:"data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:"data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:"data-mce-last-selected",lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},El=Zo("th,td,caption"),Pl=Zo("th,td"),Nl=Jo,zl=Nr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Ll=K({},zl),_l=uu((function(e){return e<0})),Wl=uu(y),jl=Nr([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Fl=K(K({},jl),{from:function(e){return ee(e,"%")?lu("%",jl.percent,e):ee(e,"px")?lu("px",jl.pixels,e):jl.invalid(e)}}),Hl=function(e){if(0===e.length)return e;var n,t,r=I(e,(function(e,n){var t=Fl.from(n).fold((function(){return{value:n,remainder:0}}),(function(e){return n=e,{value:(t=Math.floor(n))+"px",remainder:n-t};var n,t}),(function(e){return{value:e+"%",remainder:0}}));return{output:[t.value].concat(e.output),remainder:e.remainder+t.remainder}}),{output:[],remainder:0}),o=r.output;return o.slice(0,o.length-1).concat([(n=o[o.length-1],t=Math.round(r.remainder),Fl.from(n).fold(u(n),(function(e){return e+t+"px"}),(function(e){return e+t+"%"})))])},Vl=Fl.from,ql=vu(["compare","extract","mutate","sink"]),Ul=vu(["element","start","stop","destroy"]),Gl=vu(["forceDrop","drop","move","delayDrop"]),$l=function(e,n,t,r){e.dom.removeEventListener(n,t,r)},Kl=y,Xl=wu,Yl=xu("ephox-dragster").resolve,Jl=ql({compare:function(e,n){return no(n.left-e.left,n.top-e.top)},extract:function(e){return q.some(no(e.x,e.y))},sink:function(e,n){var t,r,o,i=(t=n,r=K({layerClass:Yl("blocker")},t),Bn(o=Ve.fromTag("div"),"role","presentation"),Vn(o,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Su(o,Yl("blocker")),Su(o,r.layerClass),{element:u(o),destroy:function(){Xt(o)}}),c=yu(i.element(),"mousedown",e.forceDrop),l=yu(i.element(),"mouseup",e.drop),a=yu(i.element(),"mousemove",e.move),f=yu(i.element(),"mouseout",e.delayDrop);return Ul({element:i.element,start:function(e){Kt(e,i.element())},stop:function(){Xt(i.element())},destroy:function(){i.destroy(),l.unbind(),a.unbind(),f.unbind(),c.unbind()}})},mutate:function(e,n){e.mutate(n.left,n.top)}}),Ql=function(e){return e.dom.contentEditable},Zl=xu("ephox-snooker").resolve,ea=Zl("resizer-bar"),na=Zl("resizer-rows"),ta=Zl("resizer-cols"),ra=Zl("resizer-bar-dragging"),oa={structure:!1,style:!0},ua={structure:!0,style:!1},ia={structure:!0,style:!0},ca={"border-collapse":"collapse",width:"100%"},la=R(5,(function(e){var n=e+1+"px";return{title:n,value:n}})),aa=D(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],(function(e){return{title:e,value:e.toLowerCase()}})),fa={border:"1"},sa="preservetable",ma=function(e){return"fixed"===Lu(e)||!1===_u(e)},da=function(e){return"responsive"===Lu(e)},ga=function(e){var n=yo(e);mu(e,q.some(n),q.none()),oi(e)},pa=function(e){var n=br(e)+"px";mu(e,q.some(n),q.none()),oi(e)},ba=function(e){Gn(e,"width");var n=nt(e);O(0<n.length?n:et(e),(function(e){Gn(e,"width"),oi(e)})),oi(e)},ha="bar-",va=function(e,n,t){return e.property().isText(n)&&0===e.property().getText(n).trim().length||e.property().isComment(n)?t(n).bind((function(n){return va(e,n,t).orThunk((function(){return q.some(n)}))})):q.none()},wa=function(e,n){var t=va(e,n,e.query().prevSibling).getOr(n);if(e.property().isText(t))return ii(t,ci(e,t));var r=e.property().children(t);return 0<r.length?wa(e,r[r.length-1]):ii(t,ci(e,t))},ya=wa,Ca=Qt(),Sa=en("th"),Ta=function(e){var n=k(e,(function(e){return Sa(e.element)}));return 0===n.length?q.some("td"):n.length===e.length?q.some("th"):q.none()},xa=di,Ra=gi,Da=pi,Oa=function(e){return{isValue:y,isError:w,getOr:u(e),getOrThunk:u(e),getOrDie:u(e),or:function(n){return Oa(e)},orThunk:function(n){return Oa(e)},fold:function(n,t){return t(e)},map:function(n){return Oa(n(e))},mapError:function(n){return Oa(e)},each:function(n){n(e)},bind:function(n){return n(e)},exists:function(n){return n(e)},forall:function(n){return n(e)},toOptional:function(){return q.some(e)}}},Aa=function(e){return{isValue:w,isError:y,getOr:i,getOrThunk:function(e){return e()},getOrDie:function(){return n=String(e),function(){throw new Error(n)}();var n},or:i,orThunk:function(e){return e()},fold:function(n,t){return n(e)},map:function(n){return Aa(e)},mapError:function(n){return Aa(n(e))},each:o,bind:function(n){return Aa(e)},exists:w,forall:y,toOptional:q.none}},ka={value:Oa,error:Aa,fromOption:function(e,n){return e.fold((function(){return Aa(n)}),Oa)}},Ia=en("col"),Ba=en("colgroup"),Ma=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Ea=Qt(),Pa=ic("thead",!0),Na=ic("tbody",!1),za=ic("tfoot",!1),La=wl("th"),_a=wl("td"),Wa=Ti((function(e,n,t,r){var o=n[0].row;return oc(I(uc(n),(function(e,n){return{grid:ji(e.grid,o,n.row+e.delta,t,r.getOrInit),delta:e.delta+1}}),{grid:e,delta:0}).grid,o,n[0].column)}),Ri,o,o,vl),ja=Ti((function(e,n,t,r){var o=uc(n),u=o[o.length-1],i=u.row+u.rowspan;return oc(I(o,(function(e,n){return ji(e,i,n.row,t,r.getOrInit)}),e),i,n[0].column)}),Ri,o,o,vl),Fa=Ti((function(e,n,t,r){var o=n.details,u=Xi(o),i=u[0].column;return oc(I(u,(function(e,n){return{grid:Fi(e.grid,i,n.column+e.delta,t,r.getOrInit),delta:e.delta+1}}),{grid:e,delta:0}).grid,o[0].row,i)}),dc(!0),ac,o,vl),Ha=Ti((function(e,n,t,r){var o=n.details,u=o[o.length-1],i=u.column+u.colspan;return oc(I(Xi(o),(function(e,n){return Fi(e,i,n.column,t,r.getOrInit)}),e),o[0].row,i)}),dc(!1),ac,o,vl),Va=Ti((function(e,n,t,r){var o,u,i=Xi(n.details),c=(o=e,u=D(i,(function(e){return e.column})),N(o,(function(e){var n=e.cells,t=I(u,(function(e,n){return 0<=n&&n<e.length?e.slice(0,n).concat(e.slice(n+1)):e}),n);return 0<t.length?[ye(e.element,t,e.section,e.isNew)]:[]}))),l=0<c.length?c[0].cells.length-1:0;return oc(c,i[0].row,Math.min(i[0].column,l))}),(function(e,n){return Di(e,n).map((function(n){return{details:n,pixelDelta:-mc(e,n)}}))}),ac,tc,vl),qa=Ti((function(e,n,t,r){var o,u,i,c,l=uc(n),a=(o=l[0].row,u=l[l.length-1].row,c=(i=dt(e)).rows,i.cols.concat(c.slice(0,o)).concat(c.slice(u+1))),f=0<a.length?a.length-1:0;return oc(a,Math.min(n[0].row,f),n[0].column)}),Ri,o,tc,vl),Ua=Ti((function(e,n,t,r){return oc($i(e,D(Xi(n),(function(e){return e.column})),!0,t,r.replaceOrInit),n[0].row,n[0].column)}),Di,o,o,La),Ga=Ti((function(e,n,t,r){return oc($i(e,D(Xi(n),(function(e){return e.column})),!1,t,r.replaceOrInit),n[0].row,n[0].column)}),Di,o,o,_a),$a=Ti(Pa,Di,o,o,La),Ka=Ti(Na,Di,o,o,_a),Xa=Ti(za,Di,o,o,_a),Ya=Ti((function(e,n,t,r){return oc(Ki(e,n,t,r.replaceOrInit),n[0].row,n[0].column)}),Di,o,o,La),Ja=Ti((function(e,n,t,r){return oc(Ki(e,n,t,r.replaceOrInit),n[0].row,n[0].column)}),Di,o,o,_a),Qa=Ti((function(e,n,t,r){var o=n.cells;return function(e){function n(e){return"br"===Ye(e)}var t,r=0===(t=N(e,(function(e){var t=ln(e);return z(t,(function(e){return n(e)||pn(e)&&0===Mt(e).trim().length}))?[]:t.concat(function(e){return Po(e).bind((function(t){var r=cn(t).map((function(e){return!!Zi(e)||(n=e,!!T(["br","img","hr","input"],Ea.property().name(n))&&"img"!==Ye(e));var n})).getOr(!1);return rn(t).map((function(o){return!0===r||"li"===Ye(u=o)||Rn(u,ec).isSome()||n(t)||Zi(o)&&!ce(e,o)?[]:[Ve.fromTag("br")];var u}))})).getOr([])}(e))}))).length?[Ve.fromTag("br")]:t;It(e[0]),kt(e[0],r)}(o),rc(function(e,n,t){var r=dt(e).rows;if(0===r.length)return e;for(var o=n.startRow;o<=n.finishRow;o++)for(var u=n.startCol;u<=n.finishCol;u++){var i=r[o],c=ft(i,u).isLocked;at(i,u,we(t(),!1,c))}return e}(e,n.bounds,r.merge(o)),q.from(o[0]))}),Ai,lc,o,yl),Za=Ti((function(e,n,t,r){return rc(I(n,(function(e,n){return Ii(e,n,t,r.unmerge(n))}),e),q.from(n[0]))}),ki,lc,o,yl),ef=Ti((function(e,n,t,r){var o,u,i=(o=n.clipboard,u=n.generators,wi(Gt.fromTable(o),u,!0));return function(e,n,t,r,o){var u,i,c,l=bt(n),a=(u=e,i=l,c=mt(n[0]),{row:dt(n).cols.length+u.row,column:M(R(c-u.column,(function(e){return e+u.column})),(function(e){return z(i,(function(n){return n!==e}))})).getOr(c-1)}),f=dt(t).rows,s=Li(a,f,l);return function(e,n,t){if(e.row>=n.length||e.column>mt(n[0]))return ka.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column);var r=n.slice(e.row),o=r[0].cells.slice(e.column),u=mt(t[0]),i=t.length;return ka.value({rowDelta:r.length-i,colDelta:o.length-u})}(a,n,f).map((function(e){var t=K(K({},e),{colDelta:e.colDelta-s.length}),u=zi(n,t,r),i=bt(u),c=Li(a,f,i);return function(e,n,t,r,o,u){for(var i,c,l,a,f,s=e.row,m=e.column,d=s+t.length,g=m+mt(t[0])+u.length,p=L(u,y),h=s;h<d;h++)for(var v,w,C,S=0,T=m;T<g;T++)p[T]?S++:(l=T,a=void 0,a=b(o,ft((i=n)[c=h],l).element),f=i[c],1<i.length&&1<mt(f)&&(0<l&&a(st(f,l-1))||l<f.cells.length-1&&a(st(f,l+1))||0<c&&a(st(i[c-1],l))||c<i.length-1&&a(st(i[c+1],l)))&&Ii(n,st(n[h],T),o,r.cell),w=(v=ft(t[h-s],T-m-S)).element,C=r.replace(w),at(n[h],T,we(C,!0,v.isLocked)));return n}(a,u,f,r,o,c)}))}({row:n.row,column:n.column},e,i,n.generators,t).fold((function(){return rc(e,q.some(n.element))}),(function(e){return oc(e,n.row,n.column)}))}),(function(e,n){return Zn(n.element).bind((function(t){return Ci(e,t).map((function(e){return K(K({},e),{generators:n.generators,clipboard:n.clipboard})}))}))}),lc,o,vl),nf=Ti((function(e,n,t,r){var o=dt(e).rows,u=n.cells[0].column,i=o[n.cells[0].row];return oc(_i(u,e,cc(n.clipboard,n.generators,i),n.generators,t),n.cells[0].row,n.cells[0].column)}),gc(!0),o,o,vl),tf=Ti((function(e,n,t,r){var o=dt(e).rows,u=n.cells[n.cells.length-1].column+n.cells[n.cells.length-1].colspan,i=o[n.cells[0].row];return oc(_i(u,e,cc(n.clipboard,n.generators,i),n.generators,t),n.cells[0].row,n.cells[0].column)}),gc(!1),o,o,vl),rf=Ti((function(e,n,t,r){var o=dt(e).rows,u=n.cells[0].row,i=o[u];return oc(Wi(u,e,cc(n.clipboard,n.generators,i),n.generators,t),n.cells[0].row,n.cells[0].column)}),xi,o,o,vl),of=Ti((function(e,n,t,r){var o=dt(e).rows,u=n.cells[n.cells.length-1].row+n.cells[n.cells.length-1].rowspan,i=o[n.cells[0].row];return oc(Wi(u,e,cc(n.clipboard,n.generators,i),n.generators,t),n.cells[0].row,n.cells[0].column)}),xi,o,o,vl),uf=function(e,n){var t=Gt.fromTable(e);return Ri(t,n).bind((function(e){var n=e[e.length-1],r=e[0].row,o=n.row+n.rowspan;return function(){var e=D(t.all.slice(r,o),(function(e){return fi(e).type})),n=T(e,"header"),u=T(e,"footer");if(n||u){var i=T(e,"body");return!n||i||u?n||i||!u?q.none():q.some("footer"):q.some("header")}return q.some("body")}()})).getOr("")},cf={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},lf=tinymce.util.Tools.resolve("tinymce.util.Tools"),af=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],ff=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,sf=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,mf=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,df=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,gf=function(e){return D(e,(function(e){var n=e.text||e.title;return Nc(e)?{text:n,items:gf(e.menu)}:{text:n,value:e.value}}))},pf=function(e,n,t,r,o){return D(t,(function(t){var u,i,c,l,a=t.text||t.title;return Nc(t)?{type:"nestedmenuitem",text:a,getSubmenuItems:function(){return pf(e,n,t.menu,r,o)}}:{text:a,type:"togglemenuitem",onAction:function(){return o(t.value)},onSetup:(u=e,i=n,c=r,l=t.value,function(e){function n(){function n(e){return u.formatter.match(c,{value:l},e.dom,r)}var o=Nl(i);r?(e.setActive(!x(o,n)),t.set(u.formatter.formatChanged(c,(function(n){return e.setActive(!n)}),!0))):(e.setActive(z(o,n)),t.set(u.formatter.formatChanged(c,e.setActive,!1,{value:l})))}var t=Ec((function(e){return e.unbind()})),r=!ne(l);return u.initialized?n():u.on("init",n),t.clear})}}))},bf=function(e){return N(e,(function(e){return Nc(e)?[K(K({},e),{menu:bf(e.menu)})]:ne(e.value)?[e]:[]}))},hf=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:af}],vf={normal:Vc(!1),ifTruthy:Vc(!0)},wf=b($c,["left","center","right"],"align"),yf=b($c,["top","middle","bottom"],"valign"),Cf=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Sf=function(e,n,t,r){if("TD"===n.tagName||"TH"===n.tagName)l(t)?e.setStyle(n,t,r):e.setStyle(n,t);else if(n.children)for(var o=0;o<n.children.length;o++)Sf(e,n.children[o],t,r)},Tf={remove_similar:!0,inherit:!1},xf=K({selector:"td,th"},Tf),Rf={tablecellbackgroundcolor:K({styles:{backgroundColor:"%value"}},xf),tablecellverticalalign:K({styles:{"vertical-align":"%value"}},xf),tablecellbordercolor:K({styles:{borderColor:"%value"}},xf),tablecellclass:K({classes:["%value"]},xf),tableclass:K({selector:"table",classes:["%value"]},Tf),tablecellborderstyle:K({styles:{borderStyle:"%value"}},xf),tablecellborderwidth:K({styles:{borderWidth:"%value"}},xf)},Df=Nr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Of=K(K({},Df),{none:function(e){return Df.none(e=void 0===e?void 0:e)}}),Af=function(e,n,t,r,o){void 0===o&&(o=y);var u=1===r;if(!u&&t<=0)return Of.first(e[0]);if(u&&t>=e.length-1)return Of.last(e[e.length-1]);var i=t+r,c=e[i];return o(c)?Of.middle(n,c):Af(e,n,i,r,o)},kf=function(e,n,t,r){return{start:e,soffset:n,finish:t,foffset:r}},If=Nr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Bf={before:If.before,on:If.on,after:If.after,cata:function(e,n,t,r){return e.fold(n,t,r)},getStart:function(e){return e.fold(i,i,i)}},Mf=Nr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ef={domRange:Mf.domRange,relative:Mf.relative,exact:Mf.exact,exactFromRange:function(e){return Mf.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){var n=e.match({domRange:function(e){return Ve.fromDom(e.startContainer)},relative:function(e,n){return Bf.getStart(e)},exact:function(e,n,t,r){return e}});return Ve.fromDom(tn(n).dom.defaultView)},range:kf},Pf=function(e,n){return e.selectNodeContents(n.dom)},Nf=Nr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]);function zf(e,n,t){return n>=e.left&&n<=e.right&&t>=e.top&&t<=e.bottom}function Lf(e,n){return n-e.left<e.right-n}function _f(e,n,t){var r=e.dom.createRange();return r.selectNode(n.dom),r.collapse(t),r}function Wf(e,n,t){var r=e.dom.createRange();r.selectNode(n.dom);var o=Lf(r.getBoundingClientRect(),t);return(!0===o?Eo:Po)(n).map((function(n){return _f(e,n,o)}))}function jf(e,n,t){var r=Lf(n.dom.getBoundingClientRect(),t);return q.some(_f(e,n,r))}function Ff(e,n){var t=Ye(e);return"input"===t?Bf.after(e):T(["br","img"],t)?0===n?Bf.before(e):Bf.after(e):Bf.on(e,n)}function Hf(e,n){var t=e.fold(Bf.before,Ff,Bf.after),r=n.fold(Bf.before,Ff,Bf.after);return Ef.relative(t,r)}function Vf(e,n,t,r){var o=Ff(e,n),u=Ff(t,r);return Ef.relative(o,u)}function qf(e){return q.from(e.getSelection())}function Uf(e,n){qf(e).each((function(e){e.removeAllRanges(),e.addRange(n)}))}function Gf(e,n,t,r,o){Uf(e,ll(e,n,t,r,o))}function $f(e,n){return sl(e,n).match({ltr:function(n,t,r,o){Gf(e,n,t,r,o)},rtl:function(n,t,r,o){qf(e).each((function(u){if(u.setBaseAndExtent)u.setBaseAndExtent(n.dom,t,r.dom,o);else if(u.extend)try{c=r,l=o,(i=u).collapse(n.dom,t),i.extend(c.dom,l)}catch(u){Gf(e,r,o,n,t)}else Gf(e,r,o,n,t);var i,c,l}))}})}function Kf(e,n,t,r,o){$f(e,Vf(n,t,r,o))}function Xf(e,n,t){$f(e,Hf(n,t))}function Yf(e){if(0<e.rangeCount){var n=e.getRangeAt(0),t=e.getRangeAt(e.rangeCount-1);return q.some(kf(Ve.fromDom(n.startContainer),n.startOffset,Ve.fromDom(t.endContainer),t.endOffset))}return q.none()}function Jf(e){if(null===e.anchorNode||null===e.focusNode)return Yf(e);var n,t,r,o,u,i,c,l,a,f,s,m=Ve.fromDom(e.anchorNode),d=Ve.fromDom(e.focusNode);return n=m,i=t=e.anchorOffset,c=r=d,l=o=e.focusOffset,(a=nn(u=n).dom.createRange()).setStart(u.dom,i),a.setEnd(c.dom,l),f=a,s=ce(n,r)&&t===o,f.collapsed&&!s?q.some(kf(m,e.anchorOffset,d,e.focusOffset)):Yf(e)}function Qf(e,n,t){Uf(e,((t=void 0===t||t)?il:ul)(e,n))}function Zf(e){return qf(e).filter((function(e){return 0<e.rangeCount})).bind(Jf).map((function(e){return Ef.exact(e.start,e.soffset,e.finish,e.foffset)}))}function es(e,n,t){return Es(e,n,(o=Du,ol(r=t,void 0).fold((function(){return Of.none(r)}),(function(e){return Af(e.all,r,e.index,1,o)}))));var r,o}function ns(e,n){var t=ml(e,n);return kf(Ve.fromDom(t.startContainer),t.startOffset,Ve.fromDom(t.endContainer),t.endOffset)}function ts(e,n){return{item:e,mode:n}}function rs(e,n,t,r){return void 0===r&&(r=ks),e.property().parent(n).map((function(e){return ts(e,r)}))}function os(e){return function(n){return 0===e.property().children(n).length}}function us(e,n){return Vs(Us,e,os(Us),n)}function is(e,n){return qs(Us,e,os(Us),n)}function cs(e){return kn(e,"tr")}function ls(e){return"br"===Ye(e)}function as(e,n){return{left:e.left,top:e.top+n,right:e.right,bottom:e.bottom+n}}function fs(e,n){return{left:e.left,top:e.top-n,right:e.right,bottom:e.bottom-n}}function ss(e,n,t){return{left:e.left+n,top:e.top+t,right:e.right+n,bottom:e.bottom+t}}function ms(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}function ds(e,n){return q.some(e.getRect(n))}function gs(e,n,t){return gn(n)?ds(e,n).map(ms):pn(n)?(r=e,o=n,(0<=(u=t)&&u<Bo(o)?r.getRangedRect(o,u,o,u+1):0<u?r.getRangedRect(o,u-1,o,u):q.none()).map(ms)):q.none();var r,o,u}function ps(e,n){return gn(n)?ds(e,n).map(ms):pn(n)?e.getRangedRect(n,0,n,Bo(n)).map(ms):q.none()}function bs(e,n,t){return xn((function(e,n){return n(e)}),Rn,n,Zi,void 0).fold(w,(function(n){return ps(e,n).exists((function(e){return(n=t).left<(r=e).left||Math.abs(r.right-n.left)<1||n.left>r.right;var n,r}))}))}function hs(e,n,t){var r,o=e.move(t,5),u=Qs(n,e,t,o,100).getOr(o),i=u,c=n;return((r=e).point(i)>c.getInnerHeight()?q.some(r.point(i)-c.getInnerHeight()):r.point(i)<0?q.some(-r.point(i)):q.none()).fold((function(){return n.situsFromPoint(u.left,e.point(u))}),(function(t){return n.scrollBy(0,t),n.situsFromPoint(u.left,e.point(u)-t)}))}function vs(e,n,t,r,o){return kn(r,"td,th",n).bind((function(r){return kn(r,"table",n).bind((function(u){return a=u,Rn(o,(function(e){return rn(e).exists((function(e){return ce(e,a)}))}),void 0).isSome()?(i=f=e,c=s=n,l=m=t,i.getSelection().bind((function(e){return function(e,n,t,r){var o,u,i,c,l,a,f;return(ls(n)?(o=e,(i=r).traverse(u=n).orThunk((function(){return Xs(u,i.gather,o)})).map(i.relative)):(c=e,l=r,an(a=n,f=t).filter(ls).orThunk((function(){return an(a,f-1).filter(ls)})).bind((function(e){return l.traverse(e).fold((function(){return Xs(e,l.gather,c).map(l.relative)}),(function(e){return rn(n=e).bind((function(e){var t=ln(e);return Ks(t,n).map((function(r){return{parent:e,children:t,element:n,index:r}}))})).map((function(e){return Bf.on(e.parent,e.index)}));var n}))})))).map((function(e){return{start:e,finish:e}}))}(c,e.finish,e.foffset,l).fold((function(){return q.some(ii(e.finish,e.foffset))}),(function(n){var t=i.fromSitus(n),r=$s.verify(i,e.finish,e.foffset,t.finish,t.foffset,l.failure,c);return $s.cata(r,(function(e){return q.none()}),(function(){return q.none()}),(function(e){return q.some(ii(e,0))}),(function(e){return q.some(ii(e,Bo(e)))}))}))})).bind((function(e){return em(f,s,e.element,e.offset,m,20).map(f.fromSitus)})).bind((function(e){return kn(e.finish,"td,th",n).map((function(n){return{start:r,finish:n,range:e}}))}))):q.none();var i,c,l,a,f,s,m}))}))}function ws(e,n,t,r,o,u){return He().browser.isIE()?q.none():u(r,n).orThunk((function(){return vs(e,n,t,r,o).map((function(e){var n=e.range;return Ns(q.some(Ls(n.start,n.soffset,n.finish,n.foffset)),!0)}))}))}function ys(e,n){return kn(e,"tr",n).bind((function(e){return kn(e,"table",n).bind((function(t){var r=dn(t,"tr");return ce(e,r[0])?Vs(Us,t,(function(e){return Po(e).isSome()}),n).map((function(e){var n=Bo(e);return Ns(q.some(Ls(e,n,e,n)),!0)})):q.none()}))}))}function Cs(e,n){return kn(e,"tr",n).bind((function(e){return kn(e,"table",n).bind((function(t){var r=dn(t,"tr");return ce(e,r[r.length-1])?qs(Us,t,(function(e){return Eo(e).isSome()}),n).map((function(e){return Ns(q.some(Ls(e,0,e,0)),!0)})):q.none()}))}))}function Ss(e,n,t,r,o,u,i){return vs(e,t,r,o,u).bind((function(e){return _s(n,t,e.start,e.finish,i)}))}function Ts(e,n){return kn(e,"td,th",n)}function xs(e){return function(n){return n===e}}function Rs(e){return 37<=e&&e<=40}function Ds(e){return{elementFromPoint:function(n,t){return Ve.fromPoint(Ve.fromDom(e.document),n,t)},getRect:function(e){return e.dom.getBoundingClientRect()},getRangedRect:function(n,t,r,o){var u,i,c,l=Ef.exact(n,t,r,o);return 0<(i=0<(c=(u=ml(e,l)).getClientRects()).length?c[0]:u.getBoundingClientRect()).width||0<i.height?q.some(i).map(al):q.none()},getSelection:function(){return Zf(e).map((function(n){return ns(e,n)}))},fromSitus:function(n){var t=Ef.relative(n.start,n.finish);return ns(e,t)},situsFromPoint:function(n,t){return r=n,o=t,u=Ve.fromDom(e.document),Bs(u,r,o).map((function(e){return kf(Ve.fromDom(e.startContainer),e.startOffset,Ve.fromDom(e.endContainer),e.endOffset)})).map((function(e){return zs(e.start,e.soffset,e.finish,e.foffset)}));var r,o,u},clearSelection:function(){qf(e).each((function(e){return e.removeAllRanges()}))},collapseSelection:function(n){void 0===n&&(n=!1),Zf(e).each((function(t){return t.fold((function(e){return e.collapse(n)}),(function(t,r){var o=n?t:r;Xf(e,o,o)}),(function(t,r,o,u){var i=n?t:o,c=n?r:u;Kf(e,i,c,i,c)}))}))},setSelection:function(n){Kf(e,n.start,n.soffset,n.finish,n.foffset)},setRelativeSelection:function(n,t){Xf(e,n,t)},selectNode:function(n){Qf(e,n,!1)},selectContents:function(n){Qf(e,n)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){var n=Ve.fromDom(e.document),t=void 0!==n?n.dom:document,r=t.body.scrollLeft||t.documentElement.scrollLeft,o=t.body.scrollTop||t.documentElement.scrollTop;return no(r,o).top},scrollBy:function(n,t){var r,o=n,u=t,i=Ve.fromDom(e.document);(r=(void 0!==i?i.dom:document).defaultView)&&r.scrollBy(o,u)}}}function Os(e,n){return{rows:e,cols:n}}function As(e){return!1===Tu(Ve.fromDom(e.target),"ephox-snooker-resizer-bar")}function ks(e,n,t,r){return void 0===r&&(r=Ws),t.sibling(e,n).map((function(e){return ts(e,r)}))}Nf.ltr,Nf.rtl;var Is=function(e,n,t,r){return pn(n)?(u=n,i=t,c=r,(l=(o=e).dom.createRange()).selectNode(u.dom),H(l.getClientRects(),(function(e){return zf(e,i,c)?q.some(e):q.none()})).map((function(e){return function(e,n,t,r,o){function u(t){var r=e.dom.createRange();return r.setStart(n.dom,t),r.collapse(!0),r}var i=Mt(n).length,c=function(e,n,t,r){if(0===r)return 0;if(e===t)return r-1;for(var o=t,i=1;i<r;i++){var c=u(i).getBoundingClientRect(),l=Math.abs(e-c.left);if(n<=c.bottom){if(n<c.top||o<l)return i-1;o=l}}return 0}(t,r,o.right,i);return u(c)}(o,u,i,c,e)}))):(f=n,s=t,m=r,d=(a=e).dom.createRange(),H(ln(f),(function(e){return d.selectNode(e.dom),zf(d.getBoundingClientRect(),s,m)?Is(a,e,s,m):q.none()})));var o,u,i,c,l,a,f,s,m,d},Bs=document.caretPositionFromPoint?function(e,n,t){var r,o;return q.from(null===(o=(r=e.dom).caretPositionFromPoint)||void 0===o?void 0:o.call(r,n,t)).bind((function(n){if(null===n.offsetNode)return q.none();var t=e.dom.createRange();return t.setStart(n.offsetNode,n.offset),t.collapse(),q.some(t)}))}:document.caretRangeFromPoint?function(e,n,t){var r,o;return q.from(null===(o=(r=e.dom).caretRangeFromPoint)||void 0===o?void 0:o.call(r,n,t))}:function(e,n,t){return Ve.fromPoint(e,n,t).bind((function(r){function o(){return t=e,u=n,(0===ln(o=r).length?jf:Wf)(t,o,u);var t,o,u}return 0===ln(r).length?o():function(e,n,t,r){var o=e.dom.createRange();o.selectNode(n.dom);var u=o.getBoundingClientRect();return function(e,n,t,r){var o=e.dom.createRange();o.selectNode(n.dom);var u=o.getBoundingClientRect(),i=Math.max(u.left,Math.min(u.right,t)),c=Math.max(u.top,Math.min(u.bottom,r));return Is(e,n,i,c)}(e,n,Math.max(u.left,Math.min(u.right,t)),Math.max(u.top,Math.min(u.bottom,r)))}(e,r,n,t).orThunk(o)}))},Ms=tinymce.util.Tools.resolve("tinymce.util.VK"),Es=function(e,n,t){return t.fold(q.none,q.none,(function(e,n){return Eo(n).map((function(e){return t=Ef.exact(e,0,e,0),r=Ef.getWin(t).dom,o=t.match({domRange:function(e){var n=Ve.fromDom(e.startContainer),t=Ve.fromDom(e.endContainer);return Vf(n,e.startOffset,t,e.endOffset)},relative:Hf,exact:Vf}),sl(r,o).match({ltr:n,rtl:n});function n(e,n,t,o){return ll(r,e,n,t,o)}var t,r,o}))}),(function(t){return e.execCommand("mceTableInsertRowAfter"),es(e,n,t)}))},Ps=["table","li","dl"],Ns=function(e,n){return{selection:e,kill:n}},zs=function(e,n,t,r){return{start:Bf.on(e,n),finish:Bf.on(t,r)}},Ls=zs,_s=function(e,n,t,r,o){return ce(t,r)?q.none():nr(t,r,n).bind((function(n){var r=n.boxes.getOr([]);return 1<r.length?(o(e,r,n.start,n.finish),q.some(Ns(q.some(Ls(t,0,t,Bo(t))),!0))):q.none()}))},Ws=function(e,n,t,r){void 0===r&&(r=Ws);var o=e.property().children(n);return t.first(o).map((function(e){return ts(e,r)}))},js=[{current:rs,next:ks,fallback:q.none()},{current:ks,next:Ws,fallback:q.some(rs)},{current:Ws,next:Ws,fallback:q.some(ks)}],Fs=function(e,n,t,r,o){return M(o=void 0===o?js:o,(function(e){return e.current===t})).bind((function(t){return t.current(e,n,r,t.next).orThunk((function(){return t.fallback.bind((function(t){return Fs(e,n,t,r)}))}))}))},Hs=function(e,n,t,r,o,u){return Fs(e,n,r,o).bind((function(n){return u(n.item)?q.none():t(n.item)?q.some(n.item):Hs(e,n.item,t,n.mode,o,u)}))},Vs=function(e,n,t,r){return Hs(e,n,t,ks,{sibling:function(e,n){return e.query().prevSibling(n)},first:function(e){return 0<e.length?q.some(e[e.length-1]):q.none()}},r)},qs=function(e,n,t,r){return Hs(e,n,t,ks,{sibling:function(e,n){return e.query().nextSibling(n)},first:function(e){return 0<e.length?q.some(e[0]):q.none()}},r)},Us=Qt(),Gs=Nr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),$s=K(K({},Gs),{verify:function(e,n,t,r,o,u,i){return kn(r,"td,th",i).bind((function(t){return kn(n,"td,th",i).map((function(n){return ce(t,n)?ce(r,t)&&Bo(t)===o?u(n):Gs.none("in same cell"):Zt(cs,[t,n]).fold((function(){return o=t,i=(r=e).getRect(n),(c=r.getRect(o)).right>i.left&&c.left<i.right?Gs.success():u(n);var r,o,i,c}),(function(e){return u(n)}))}))})).getOr(Gs.none("default"))},cata:function(e,n,t,r,o){return e.fold(n,t,r,o)}}),Ks=function(e,n){return E(e,b(ce,n))},Xs=function(e,n,t){return n(e,t).bind((function(e){return pn(e)&&0===Mt(e).trim().length?Xs(e,n,t):q.some(e)}))},Ys=Nr([{none:[]},{retry:["caret"]}]),Js={point:function(e){return e.bottom},adjuster:function(e,n,t,r,o){var u=as(o,5);return Math.abs(t.bottom-r.bottom)<1||t.top>o.bottom?Ys.retry(u):t.top===o.bottom?Ys.retry(as(o,1)):bs(e,n,o)?Ys.retry(ss(u,5,0)):Ys.none()},move:as,gather:is},Qs=function(e,n,t,r,o){return 0===o?q.some(r):(i=e,c=r.left,l=n.point(r),i.elementFromPoint(c,l).filter((function(e){return"table"===Ye(e)})).isSome()?(u=o-1,Qs(e,n,t,n.move(r,5),u)):e.situsFromPoint(r.left,n.point(r)).bind((function(u){return u.start.fold(q.none,(function(u){return ps(e,u).bind((function(i){return n.adjuster(e,u,i,t,r).fold(q.none,(function(r){return Qs(e,n,t,r,o-1)}))})).orThunk((function(){return q.some(r)}))}),q.none)})));var u,i,c,l},Zs={tryUp:b(hs,{point:function(e){return e.top},adjuster:function(e,n,t,r,o){var u=fs(o,5);return Math.abs(t.top-r.top)<1||t.bottom<o.top?Ys.retry(u):t.bottom===o.top?Ys.retry(fs(o,1)):bs(e,n,o)?Ys.retry(ss(u,5,0)):Ys.none()},move:fs,gather:us}),tryDown:b(hs,Js),ieTryUp:function(e,n){return e.situsFromPoint(n.left,n.top-5)},ieTryDown:function(e,n){return e.situsFromPoint(n.left,n.bottom+5)},getJumpSize:u(5)},em=function(e,n,t,r,o,u){return 0===u?q.none():rm(e,n,t,r,o).bind((function(i){var c=e.fromSitus(i),l=$s.verify(e,t,r,c.finish,c.foffset,o.failure,n);return $s.cata(l,(function(){return q.none()}),(function(){return q.some(i)}),(function(i){return ce(t,i)&&0===r?nm(e,t,r,fs,o):em(e,n,i,0,o,u-1)}),(function(i){return ce(t,i)&&r===Bo(i)?nm(e,t,r,as,o):em(e,n,i,Bo(i),o,u-1)}))}))},nm=function(e,n,t,r,o){return gs(e,n,t).bind((function(n){return tm(e,o,r(n,Zs.getJumpSize()))}))},tm=function(e,n,t){var r=He().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?n.otherRetry(e,t):r.isIE()?n.ieRetry(e,t):q.none()},rm=function(e,n,t,r,o){return gs(e,t,r).bind((function(n){return tm(e,o,n)}))},om={traverse:cn,gather:is,relative:Bf.before,otherRetry:Zs.tryDown,ieRetry:Zs.ieTryDown,failure:$s.failedDown},um={traverse:un,gather:us,relative:Bf.before,otherRetry:Zs.tryUp,ieRetry:Zs.ieTryUp,failure:$s.failedUp},im=xs(38),cm=xs(40),lm={isBackward:xs(37),isForward:xs(39)},am={isBackward:xs(39),isForward:xs(37)},fm=tinymce.util.Tools.resolve("tinymce.Env");function sm(e,n,t){var r=function(n,t,r){function o(e){_t(e,n.selected),_t(e,n.firstSelected),_t(e,n.lastSelected)}function u(e){Bn(e,n.selected,"1")}function i(n){c(n),e.fire("TableSelectionClear")}function c(e){O(dn(e,n.selectedSelector+","+n.firstSelectedSelector+","+n.lastSelectedSelector),o)}return{clearBeforeUpdate:c,clear:i,selectRange:function(e,r,o,c){i(e),O(r,u),Bn(o,n.firstSelected,"1"),Bn(c,n.lastSelected,"1"),t(r,o,c)},selectedSelector:n.selectedSelector,firstSelectedSelector:n.firstSelectedSelector,lastSelectedSelector:n.lastSelectedSelector}}(Ml,(function(n,r,u){t.targets().each((function(t){tt(r).each((function(i){var c,l,a,f=ei(e),s=Fo(o,Ve.fromDom(e.getDoc()),f),m=(c=t,l=s,Ri(a=Gt.fromTable(i),c).map((function(e){var n,t,r=wi(a,l,!1);return{upOrLeftCells:N(yi(r.slice(0,(n=e)[n.length-1].row+1)),(function(e){return D(e.cells.slice(0,n[n.length-1].column+1),(function(e){return e.element}))})),downOrRightCells:N(yi(r.slice((t=e)[0].row+t[0].rowspan-1,r.length)),(function(e){return D(e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length),(function(e){return e.element}))}))}})));e.fire("TableSelectionChange",{cells:n,start:r,finish:u,otherCells:m})}))}))}));return e.on("init",(function(t){var u,i,c,l,a,f,s,m,d,g,p,h,v,w,y,C,S=e.getWin(),T=qo(e),x=$o(e),R=(u=Ds(S),{clearstate:(p=u,h=T,v=x,w=r,y=Pc(),(i={clearstate:C=y.clear,mousedown:function(e){w.clear(h),Ts(e.target,v).each(y.set)},mouseover:function(e){k(e)},mouseup:function(e){k(e),C()}}).clearstate),mousedown:i.mousedown,mouseover:i.mouseover,mouseup:i.mouseup}),D=(g=Ds(S),{keydown:function(e,n,t,r,o,u){var i=e.raw,c=i.which,l=!0===i.shiftKey;return tr(s,d.selectedSelector).fold((function(){return Rs(c)&&!l&&d.clearBeforeUpdate(s),cm(c)&&l?b(Ss,g,s,m,om,r,n,d.selectRange):im(c)&&l?b(Ss,g,s,m,um,r,n,d.selectRange):cm(c)?b(ws,g,m,om,r,n,Cs):im(c)?b(ws,g,m,um,r,n,ys):q.none}),(function(e){function n(n){return function(){return H(n,(function(n){return t=n.rows,r=n.cols,o=s,or(e,t,r,(u=d).firstSelectedSelector,u.lastSelectedSelector).map((function(e){return u.clearBeforeUpdate(o),u.selectRange(o,e.boxes,e.start,e.finish),e.boxes}));var t,r,o,u})).fold((function(){return rr(s,d.firstSelectedSelector,d.lastSelectedSelector).map((function(e){var n=cm(c)||u.isForward(c)?Bf.after:Bf.before;return g.setRelativeSelection(Bf.on(e.first,0),n(e.table)),d.clear(s),Ns(q.none(),!0)}))}),(function(e){return q.some(Ns(q.none(),!0))}))}}return cm(c)&&l?n([Os(1,0)]):im(c)&&l?n([Os(-1,0)]):u.isBackward(c)&&l?n([Os(0,-1),Os(-1,0)]):u.isForward(c)&&l?n([Os(0,1),Os(1,0)]):Rs(c)&&!l?A:q.none}))()},keyup:function(e,n,t,r,o){return tr(s,d.selectedSelector).fold((function(){var u,i,c,l,a,f=e.raw,g=f.which;return!0===f.shiftKey&&Rs(g)?(u=s,i=m,a=d.selectRange,ce(c=n,l=r)&&t===o?q.none():kn(c,"td,th",i).bind((function(e){return kn(l,"td,th",i).bind((function(n){return _s(u,i,e,n,a)}))}))):q.none()}),q.none)}}),O=(c=s=T,l=m=x,a=d=r,f=Ds(S),function(e,n){a.clearBeforeUpdate(c),nr(e,n,l).each((function(e){var t=e.boxes.getOr([]);a.selectRange(c,t,e.start,e.finish),f.selectContents(n),f.collapseSelection()}))});function A(){return d.clear(s),q.none()}function k(e){y.on((function(n){w.clearBeforeUpdate(h),Ts(e.target,v).each((function(t){nr(n,t,v).each((function(n){var r,o,u,i=n.boxes.getOr([]);1===i.length?(r=i[0],o="false"===Ql(r),u=zn(Ru(e.target),r,ce),o&&u&&(w.selectRange(h,i,r,r),p.selectContents(r))):1<i.length&&(w.selectRange(h,i,n.start,n.finish),p.selectContents(t))}))}))}))}function I(n,t){!0===n.raw.shiftKey&&(t.kill&&n.kill(),t.selection.each((function(n){var t=Ef.relative(n.start,n.finish),r=ml(S,t);e.selection.setRng(r)})))}function B(e){return 0===e.button}e.on("TableSelectorChange",(function(e){return O(e.start,e.finish)}));var M,E,P=(M=Mc(Ve.fromDom(T)),E=Mc(0),{touchEnd:function(e){var n,t,r=Ve.fromDom(e.target);"td"!==Ye(r)&&"th"!==Ye(r)||(n=M.get(),t=E.get(),ce(n,r)&&e.timeStamp-t<300&&(e.preventDefault(),O(r,r))),M.set(r),E.set(e.timeStamp)}});e.on("dragstart",(function(e){R.clearstate()})),e.on("mousedown",(function(e){B(e)&&As(e)&&R.mousedown(Xl(e))})),e.on("mouseover",(function(e){var n;(void 0===(n=e).buttons||fm.browser.isEdge()&&0===n.buttons||0!=(1&n.buttons))&&As(e)&&R.mouseover(Xl(e))})),e.on("mouseup",(function(e){B(e)&&As(e)&&R.mouseup(Xl(e))})),e.on("touchend",P.touchEnd),e.on("keyup",(function(n){var t,r,o,u=Xl(n);u.raw.shiftKey&&Rs(u.raw.which)&&(t=e.selection.getRng(),r=Ve.fromDom(t.startContainer),o=Ve.fromDom(t.endContainer),D.keyup(u,r,t.startOffset,o,t.endOffset).each((function(e){I(u,e)})))})),e.on("keydown",(function(t){var r=Xl(t);n().each((function(e){return e.hideBars()}));var o=e.selection.getRng(),u=Ve.fromDom(o.startContainer),i=Ve.fromDom(o.endContainer),c=yr(lm,am)(Ve.fromDom(e.selection.getStart()));D.keydown(r,u,o.startOffset,i,o.endOffset,c).each((function(e){I(r,e)})),n().each((function(e){return e.showBars()}))})),e.on("NodeChange",(function(){var n=e.selection;Zt(tt,[Ve.fromDom(n.getStart()),Ve.fromDom(n.getEnd())]).fold((function(){return r.clear(T)}),o)}))})),{clear:r.clear}}function mm(e,n){function t(e){return g.forall((function(n){return!n[e]}))}function r(){return El(Yo(e),$o(e)).bind((function(t){return _n(tt(t),El(Ve.fromDom(e.selection.getEnd()),$o(e)).bind(tt),(function(e,r){return ce(e,r)?p(t)?q.some({element:o=t,mergable:q.none(),unmergable:q.none(),selection:[o]}):q.some(Qo(n,e,t)):q.none();var o})).bind(i)}))}function o(e){return tt(e.element).map((function(n){var t=Gt.fromTable(n),r=B(Ri(t,e).getOr([]),(function(e,n){return n.isLocked&&(e.onAny=!0,0===n.column?e.onFirst=!0:n.column+n.colspan>=t.grid.columns&&(e.onLast=!0)),e}),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:Ai(t,e).isSome(),unmergeable:ki(t,e).isSome(),locked:r}}))}function u(){m.set(Y(r)()),g=m.get().bind(o),O(d.get(),(function(e){return e()}))}function c(e){return e(),d.set(d.get().concat([e])),function(){d.set(k(d.get(),(function(n){return n!==e})))}}function l(e,n){return c((function(){return m.get().fold((function(){e.setDisabled(!0)}),(function(t){e.setDisabled(n(t))}))}))}function a(e,n,t){return c((function(){return m.get().fold((function(){e.setDisabled(!0),e.setActive(!1)}),(function(r){e.setDisabled(n(r)),e.setActive(t(r))}))}))}function f(e){return g.exists((function(n){return n.locked[e]}))}function s(n,t){return function(r){return a(r,(function(e){return p(e.element)}),(function(){return e.queryCommandValue(n)===t}))}}var m=Mc(q.none()),d=Mc([]),g=q.none(),p=en("caption"),b=s("mceTableRowType","header"),h=s("mceTableColType","th");return e.on("NodeChange ExecCommand TableSelectorChange",u),{onSetupTable:function(e){return l(e,(function(e){return!1}))},onSetupCellOrRow:function(e){return l(e,(function(e){return p(e.element)}))},onSetupColumn:function(e){return function(n){return l(n,(function(n){return p(n.element)||f(e)}))}},onSetupPasteable:function(e){return function(n){return l(n,(function(n){return p(n.element)||e().isNone()}))}},onSetupPasteableColumn:function(e,n){return function(t){return l(t,(function(t){return p(t.element)||e().isNone()||f(n)}))}},onSetupMergeable:function(e){return l(e,(function(e){return t("mergeable")}))},onSetupUnmergeable:function(e){return l(e,(function(e){return t("unmergeable")}))},resetTargets:u,onSetupTableWithCaption:function(n){return a(n,w,(function(n){return tt(n.element,$o(e)).exists((function(e){return On(e,"caption").isSome()}))}))},onSetupTableRowHeaders:b,onSetupTableColumnHeaders:h,targets:m.get}}$r.add("table",(function(e){var n,t,r,i,c,a,f,s,m,d,g,p,b=(n=function(){return qo(e)},t=function(){return Pl(Yo(e),$o(e))},r=Ml.selectedSelector,{get:function(){return Hr(n(),r).fold((function(){return t().fold(qr,Gr)}),(function(e){return Ur(e)}))}}),h=mm(e,b),v=function(e){function n(e){return"TABLE"===e.nodeName}function t(n){return ri(e,n)}function r(){return(Qu(e)?cu:iu)()}var o,i,c=q.none(),a=q.none(),f=q.none();return e.on("init",(function(){var n,o,i,s,m,d,g,p,b,h,v,w,y,C,S=(o=ui,(n=e).inline?(d=qo(n),Vn(p=Ve.fromTag("div"),{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Kt(Sn(Ve.fromDom(document)),p),g=o,{parent:u(p),view:u(d),origin:u(no(0,0)),isResizable:g}):dl(Ve.fromDom(n.getDoc()),o));f=q.some(S),m=e.getParam("object_resizing",!0),(l(m)?"table"===m:m)&&e.getParam("table_resize_bars",!0,"boolean")&&(i=r(),b=i,h=t,v=ro,w=uo,y=Eu(S),C=pu({beforeResize:gu(["table","type"]),afterResize:gu(["table","type"]),startDrag:gu([])}),y.events.adjustHeight.bind((function(e){var n=e.table;C.trigger.beforeResize(n,"row");var t,r,o,u,i,c,l,a,f,s=v.delta(e.delta,n);t=n,r=s,o=e.row,u=v,a=D(Oo(l=Gt.fromTable(t),t,u,vo,(function(e){return e.getOrThunk(Ft)})),(function(e,n){return o===n?Math.max(r+e,Ft()):e})),i=a,f=D(Gt.justCells(l),(function(e){var n=eu(e.row,e.row+e.rowspan,i);return{element:e.element,height:n,rowspan:e.rowspan}})),O((c=a,D(l.all,(function(e,n){return{element:e.element,height:c[n]}}))),(function(e){mo(e.element,e.height)})),O(f,(function(e){mo(e.element,e.height)})),mo(t,I(a,(function(e,n){return e+n}),0)),C.trigger.afterResize(n,"row")})),y.events.startAdjust.bind((function(e){C.trigger.startDrag()})),y.events.adjustWidth.bind((function(e){var n=e.table;C.trigger.beforeResize(n,"col");var t=w.delta(e.delta,n),r=h(n);tu(n,t,e.column,b,r),C.trigger.afterResize(n,"col")})),(s={on:y.on,off:y.off,hideBars:y.hideBars,showBars:y.showBars,destroy:y.destroy,events:C.registry}).on(),s.events.startDrag.bind((function(n){c=q.some(e.selection.getRng())})),s.events.beforeResize.bind((function(n){var t,r=n.table.dom,o=e,u=Uo(t=r),i=Go(r),c=ha+n.type;o.fire("ObjectResizeStart",{target:t,width:u,height:i,origin:c})})),s.events.afterResize.bind((function(n){var t,r,o,u,i,l=n.table,a=l.dom;Xo(l),c.each((function(n){e.selection.setRng(n),e.focus()})),t=e,o=Uo(r=a),u=Go(a),i=ha+n.type,t.fire("ObjectResized",{target:r,width:o,height:u,origin:i}),e.undoManager.add()})),a=q.some(s))})),e.on("ObjectResizeStart",(function(t){var r,u,c,l,a=t.target;n(a)&&(r=Ve.fromDom(a),O(e.dom.select(".mce-clonedresizable"),(function(n){e.dom.addClass(n,"mce-"+Ju(e)+"-columns")})),!pl(r)&&ma(e)?pa(r):!gl(r)&&Xu(e)&&ga(r),bl(r)&&Ae(t.origin,ha)&&ga(r),o=t.width,i=da(e)?"":(l=(u=e).dom.getStyle(c=a,"width")||u.dom.getAttrib(c,"width"),q.from(l).filter(ne).getOr("")))})),e.on("ObjectResized",(function(u){var c,l,a,f,s,m,d,g,p,b,h=u.target;n(h)&&(c=Ve.fromDom(h),l=u.origin,Ae(l,"corner-")&&(a=c,f=u.width,b=ee(l,"e"),""===i&&ga(a),f!==o&&""!==i?(Hn(a,"width",i),s=r(),m=t(a),d=Qu(e)||b?du(a).columns-1:0,tu(a,f-o,d,s,m)):/^(\d+(\.\d+)?)%$/.test(i)&&Hn(a,"width",f*parseFloat(i.replace("%",""))/o+"%"),/^(\d+(\.\d+)?)px$/.test(i)&&(p=Gt.fromTable(g=a),Gt.hasColumns(p)||O(et(g),(function(e){Hn(e,"width",qn(e,"width")),_t(e,"width")})))),Xo(c),zu(e,c.dom,oa))})),e.on("SwitchMode",(function(){a.each((function(n){e.mode.isReadOnly()?n.hideBars():n.showBars()}))})),{lazyResize:function(){return a},lazyWire:function(){return f.getOr(dl(Ve.fromDom(e.getBody()),ui))},destroy:function(){a.each((function(e){e.destroy()})),f.each((function(n){var t=n;e.inline&&Xt(t.parent())}))}}}(e),w=sm(e,v.lazyResize,h),C=function(e,n,t){function r(e){return"table"===Ye(qo(e))}function u(t,r,o,u,c){return function(l,a,f){void 0===f&&(f=!1),Xo(l);var s=u(),m=Ve.fromDom(e.getDoc()),d=Fo(o,m,i),g={sizing:ri(e,l),resize:(Zu(e)?iu:cu)(),section:function(n){switch(Yu(e)){case"section":return xa();case"sectionCells":return Ra();case"cells":return Da();default:return function(e,n){switch(H(Gt.fromTable(e).all,(function(e){var n=fi(e);return"header"===n.type?q.from(n.subType):q.none()})).getOr("section")){case"section":return di();case"sectionCells":return gi();case"cells":return pi()}}(n)}}(l)};return r(l)?t(s,l,a,d,g).bind((function(t){O(t.newRows,(function(n){Pu(e,n.dom)})),O(t.newCells,(function(n){Nu(e,n.dom)}));var r,o=(r=l,t.cursor.fold((function(){return j(et(r)).filter(Cn).map((function(t){n.clear(r);var o=e.dom.createRng();return o.selectNode(t.dom),e.selection.setRng(o),Bn(t,"data-mce-selected","1"),o}))}),(function(t){var o=ya(Ca,t),u=e.dom.createRng();return u.setStart(o.element.dom,o.offset),u.setEnd(o.element.dom,o.offset),e.selection.setRng(u),n.clear(r),q.some(u)})));return Cn(l)&&(Xo(l),f||zu(e,l.dom,c)),o.map((function(e){return{rng:e,effect:c}}))})):q.none()}}var i=ei(e),c=Zu(e)?o:li;return{deleteRow:u(qa,(function(n){return!1===r(e)||1<du(n).rows}),o,t,ua),deleteColumn:u(Va,(function(n){return!1===r(e)||1<du(n).columns}),o,t,ua),insertRowsBefore:u(Wa,y,o,t,ua),insertRowsAfter:u(ja,y,o,t,ua),insertColumnsBefore:u(Fa,y,c,t,ua),insertColumnsAfter:u(Ha,y,c,t,ua),mergeCells:u(Qa,y,o,t,ua),unmergeCells:u(Za,y,o,t,ua),pasteColsBefore:u(nf,y,o,t,ua),pasteColsAfter:u(tf,y,o,t,ua),pasteRowsBefore:u(rf,y,o,t,ua),pasteRowsAfter:u(of,y,o,t,ua),pasteCells:u(ef,y,o,t,ia),makeCellsHeader:u(Ya,y,o,t,ua),unmakeCellsHeader:u(Ja,y,o,t,ua),makeColumnsHeader:u(Ua,y,o,t,ua),unmakeColumnsHeader:u(Ga,y,o,t,ua),makeRowsHeader:u($a,y,o,t,ua),makeRowsBody:u(Ka,y,o,t,ua),makeRowsFooter:u(Xa,y,o,t,ua),getTableRowType:uf,getTableCellType:bc,getTableColType:pc}}(e,w,v.lazyWire),S=(i=Pc(),c=Pc(),{getRows:i.get,setRows:function(e){e.fold(i.clear,i.set),c.clear()},clearRows:i.clear,getColumns:c.get,setColumns:function(e){e.fold(c.clear,c.set),i.clear()},clearColumns:c.clear});return rl(e,C,0,b,S),d=C,g=b,p=$o(m=e),ae({mceTableRowType:function(){return x(d.getTableRowType)},mceTableCellType:function(){return x(d.getTableCellType)},mceTableColType:function(){return x(d.getTableColType)}},(function(e,n){return m.addQueryValueHandler(n,e)})),function(e,n,t){e.on("BeforeGetContent",(function(t){!0===t.selection&&ur(n.get(),o,(function(n){t.preventDefault(),tt(n[0]).map((function(e){var n=function(e,n){function t(e){return oe(e.element,n)}var r,o,u,i,c,l,a,f,s,m,d,g,p=lr(e),b=it(p),h=Dl(e),v=Gt.generate(b),w=(r=t,o=v.grid.columns,u=v.grid.rows,i=o,l=c=0,a=[],f=[],ae(v.access,(function(e){var n,t,o,s;a.push(e),r(e)&&(f.push(e),t=(n=e.row)+e.rowspan-1,s=(o=e.column)+e.colspan-1,n<u?u=n:c<t&&(c=t),o<i?i=o:l<s&&(l=s))})),{minRow:u,minCol:i,maxRow:c,maxCol:l,allCells:a,selectedCells:f});return O(Ht(p,"th,td",(function(e){return oe(e,"th:not([data-mce-selected]),td:not([data-mce-selected])")})),Xt),function(e,n,t,r){for(var o,u,i,c=n.grid.columns,l=n.grid.rows,a=0;a<l;a++)for(var f=!1,s=0;s<c;s++)a<t.minRow||a>t.maxRow||s<t.minCol||s>t.maxCol||(Gt.getAt(n,a,s).filter(r).isNone()?(o=f,u=e[a].element,i=Ve.fromTag("td"),Kt(i,Ve.fromTag("br")),(o?Kt:Dt)(u,i)):f=!0)}(b,v,w,t),s=p,m=w,d=v,g=function(e,n,t,r){if(0===r.minCol&&n.grid.columns===r.maxCol+1)return 0;var o=Do(n,e,t),u=B(o,(function(e,n){return e+n}),0),i=B(o.slice(r.minCol,r.maxCol+1),(function(e,n){return e+n}),0)/u*t.pixelWidth()-t.pixelWidth();return t.getCellDelta(i)}(e,Gt.fromTable(e),h,w),ae(d.columns,(function(e){(e.column<m.minCol||e.column>m.maxCol)&&Xt(e.element)})),O(k(Qn(s,"tr"),(function(e){return 0===e.dom.childElementCount})),Xt),m.minCol!==m.maxCol&&m.minRow!==m.maxRow||O(Qn(s,"th,td"),(function(e){_t(e,"rowspan"),_t(e,"colspan")})),_t(s,Ut),_t(s,"data-snooker-col-series"),Dl(s).adjustTableWidth(g),p}(e,"[data-mce-selected]");return Xo(n),[n]})).each((function(n){var r;t.content="text"===t.format?D(n,(function(e){return e.dom.innerText})).join(""):(r=e,D(n,(function(e){return r.selection.serializer.serialize(e.dom,{})})).join(""))}))}),o)})),e.on("BeforeSetContent",(function(r){!0===r.selection&&!0===r.paste&&j(Nl(n)).each((function(n){tt(n).each((function(o){var u,i,c,l,a=k((u=r.content,(i=document.createElement("div")).innerHTML=u,ln(Ve.fromDom(i))),(function(e){return"meta"!==Ye(e)})),f=en("table");1===a.length&&f(a[0])&&(r.preventDefault(),c=Ho(Ve.fromDom(e.getDoc())),l={element:n,clipboard:a[0],generators:c},t.pasteCells(o,l).each((function(){e.focus()})))}))}))}))}(e,b,C),function(e,n,t,r){function o(n){return function(){return e.execCommand(n)}}function i(n){e.execCommand("mceInsertTable",!1,{rows:n.numRows,columns:n.numColumns})}var c={text:"Table properties",onSetup:t.onSetupTable,onAction:o("mceTableProps")},l={text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,onAction:o("mceTableDelete")};e.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:o("mceTableInsertRowBefore"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:o("mceTableInsertRowAfter"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:o("mceTableDeleteRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:o("mceTableRowProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:o("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:o("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:o("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(r.getRows)}),e.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:o("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(r.getRows)});var a={type:"nestedmenuitem",text:"Row",getSubmenuItems:u("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")};e.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:o("mceTableInsertColBefore"),onSetup:t.onSetupColumn("onFirst")}),e.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:o("mceTableInsertColAfter"),onSetup:t.onSetupColumn("onLast")}),e.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:o("mceTableDeleteCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:o("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:o("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:o("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(r.getColumns,"onFirst")}),e.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:o("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(r.getColumns,"onLast")});var f={type:"nestedmenuitem",text:"Column",getSubmenuItems:u("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")};e.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:o("mceTableCellProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:o("mceTableMergeCells"),onSetup:t.onSetupMergeable}),e.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:o("mceTableSplitCells"),onSetup:t.onSetupUnmergeable});var s={type:"nestedmenuitem",text:"Cell",getSubmenuItems:u("tablecellprops tablemergecells tablesplitcells")};!1===e.getParam("table_grid",!0,"boolean")?e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:o("mceInsertTable")}):e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:i}]}}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:o("mceInsertTable")}),e.ui.registry.addMenuItem("tableprops",c),e.ui.registry.addMenuItem("deletetable",l),e.ui.registry.addNestedMenuItem("row",a),e.ui.registry.addNestedMenuItem("column",f),e.ui.registry.addNestedMenuItem("cell",s),e.ui.registry.addContextMenu("table",{update:function(){return t.resetTargets(),t.targets().fold(u(""),(function(e){return"caption"===Ye(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}});var m=bf(Ku(e));0!==m.length&&e.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:function(){return pf(e,n,m,"tableclass",(function(n){return e.execCommand("mceTableToggleClass",!1,n)}))},onSetup:t.onSetupTable});var d=bf($u(e));0!==d.length&&e.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:function(){return pf(e,n,d,"tablecellclass",(function(n){return e.execCommand("mceTableCellToggleClass",!1,n)}))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:function(){return pf(e,n,af,"tablecellverticalalign",zc(e,"vertical-align"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:function(){return pf(e,n,Wu(e),"tablecellborderwidth",zc(e,"border-width"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:function(){return pf(e,n,ju(e),"tablecellborderstyle",zc(e,"border-style"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablecaption",{icon:"table-caption",text:"Table caption",onAction:o("mceTableToggleCaption"),onSetup:t.onSetupTableWithCaption}),e.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:function(){return _c(e,ni(e),"background-color")},onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:function(){return _c(e,ti(e),"border-color")},onSetup:t.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablerowheader",{text:"Row header",icon:"table-top-header",onAction:Wc(e),onSetup:t.onSetupTableRowHeaders}),e.ui.registry.addToggleMenuItem("tablecolheader",{text:"Column header",icon:"table-left-header",onAction:jc(e),onSetup:t.onSetupTableColumnHeaders})}(e,b,h,S),function(e,n,t,r){function o(n){return function(){return e.execCommand(n)}}e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(e){return e("inserttable | cell row column | advtablesort | tableprops deletetable")}}),e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:o("mceTableProps"),icon:"table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:o("mceTableDelete"),icon:"table-delete-table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:o("mceTableCellProps"),icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:o("mceTableMergeCells"),icon:"table-merge-cells",onSetup:t.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:o("mceTableSplitCells"),icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:o("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:o("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:o("mceTableDeleteRow"),icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:o("mceTableRowProps"),icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:o("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:t.onSetupColumn("onFirst")}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:o("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:t.onSetupColumn("onLast")}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:o("mceTableDeleteCol"),icon:"table-delete-column",onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:o("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:o("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:o("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(r.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:o("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(r.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:o("mceTableCutCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:o("mceTableCopyCol"),onSetup:t.onSetupColumn("onAny")}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:o("mceTablePasteColBefore"),onSetup:t.onSetupPasteableColumn(r.getColumns,"onFirst")}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:o("mceTablePasteColAfter"),onSetup:t.onSetupPasteableColumn(r.getColumns,"onLast")}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:o("mceInsertTable"),icon:"table"});var u=bf(Ku(e));0!==u.length&&e.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:Lc(e,n,u,"tableclass",(function(n){return e.execCommand("mceTableToggleClass",!1,n)})),onSetup:t.onSetupTable});var i=bf($u(e));0!==i.length&&e.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:Lc(e,n,i,"tablecellclass",(function(n){return e.execCommand("mceTableCellToggleClass",!1,n)})),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:Lc(e,n,af,"tablecellverticalalign",zc(e,"vertical-align")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:Lc(e,n,Wu(e),"tablecellborderwidth",zc(e,"border-width")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:Lc(e,n,ju(e),"tablecellborderstyle",zc(e,"border-style")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablecaption",{tooltip:"Table caption",onAction:o("mceTableToggleCaption"),icon:"table-caption",onSetup:t.onSetupTableWithCaption}),e.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:function(n){return n(_c(e,ni(e),"background-color"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:function(n){return n(_c(e,ti(e),"border-color"))},onSetup:t.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablerowheader",{tooltip:"Row header",icon:"table-top-header",onAction:Wc(e),onSetup:t.onSetupTableRowHeaders}),e.ui.registry.addToggleButton("tablecolheader",{tooltip:"Column header",icon:"table-left-header",onAction:jc(e),onSetup:t.onSetupTableColumnHeaders})}(e,b,h,S),0<(s=(f=e).getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")).length&&f.ui.registry.addContextToolbar("table",{predicate:function(e){return f.dom.is(e,"table")&&f.getBody().contains(e)},items:s,scope:"node",position:"node"}),e.on("PreInit",(function(){e.serializer.addTempAttr(Ml.firstSelected),e.serializer.addTempAttr(Ml.lastSelected),e.formatter.register(Rf)})),e.getParam("table_tab_navigation",!0,"boolean")&&e.on("keydown",(function(n){var t,r,o,u,i=e,c=w;(t=n).keyCode===Ms.TAB&&(r=qo(i),o=function(e){var n=Ye(e);return ce(e,r)||T(Ps,n)},u=i.selection.getRng(),Zn(Ve.fromDom(t.shiftKey?u.startContainer:u.endContainer),o).each((function(e){t.preventDefault(),tt(e,o).each(c.clear),i.selection.collapse(t.shiftKey),(t.shiftKey?function(e,n,t){return Es(e,n,(o=Du,ol(r=t,void 0).fold((function(){return Of.none()}),(function(e){return Af(e.all,r,e.index,-1,o)}))));var r,o}:es)(i,o,e).each((function(e){i.selection.setRng(e)}))})))})),e.on("remove",(function(){v.destroy()})),{insertTable:(a=e,function(e,n,t){var r=yc(a,n,e,t=void 0===t?{}:t,"Invalid values for insertTable - rows and columns values are required to insert a table.");return a.undoManager.add(),r}),setClipboardRows:Sc(S.setRows),getClipboardRows:Cc(S.getRows),setClipboardCols:Sc(S.setColumns),getClipboardCols:Cc(S.getColumns),resizeHandler:v,selectionTargets:h};function x(e){return Pl(Yo(m)).bind((function(n){return tt(n,p).map((function(t){var r=Qo(g,t,n);return e(t,r)}))})).getOr("")}}))}();